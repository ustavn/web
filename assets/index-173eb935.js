import{b as m,o as x,r as c,j as e,N as h,P as u,d as j,f as p,L as f,s as N,t as g}from"./index-038953f0.js";import{A as b}from"./AccountWrapper-efea680c.js";import{u as l}from"./useTranslation-4ed3e53c.js";import{A as v}from"./Alert-bc52e707.js";import{B as w}from"./Button-3bfbac80.js";const y=()=>{const{t}=l();return e.jsx(j,{className:"mt-3",children:e.jsx(p,{className:"text-center",children:e.jsxs("p",{className:"text-muted",children:[t("Don't have an account?"),e.jsx(f,{to:"/account/register",className:"text-muted ms-1",children:e.jsx("b",{children:t("Sign Up")})})]})})})};function O(){const{t}=l(),{isAuthenticated:o}=m(),s=x(),[r,a]=c.useState(!1),n=c.useMemo(()=>s.state&&s.state.from?s.state.from.pathname:"/",[s.state]),d=async()=>{a(!0);try{N(n);const i=await g();window.location.href=i}catch(i){console.error("Failed to initiate OAuth flow:",i),a(!1)}};return e.jsxs(e.Fragment,{children:[o&&e.jsx(h,{to:n,replace:!0}),e.jsx(u,{title:"Login with OAuth 2.0"}),e.jsxs(b,{bottomLinks:e.jsx(y,{}),children:[e.jsxs("div",{className:"text-center w-75 m-auto",children:[e.jsx("h4",{className:"text-dark-50 text-center mt-0 fw-bold",children:t("Secure Sign In")}),e.jsx("p",{className:"text-muted mb-4",children:t("Click below to login securely with OAuth 2.0 via the identity server.")})]}),e.jsx(v,{variant:"info",className:"mb-4",children:e.jsxs("div",{className:"d-flex",children:[e.jsx("i",{className:"mdi mdi-information me-2",style:{fontSize:"20px"}}),e.jsxs("div",{children:[e.jsx("strong",{children:t("How it works:")}),e.jsxs("ol",{className:"mb-0 mt-2 ps-3",style:{fontSize:"0.9rem"},children:[e.jsx("li",{children:t("You will be redirected to the identity server")}),e.jsx("li",{children:t("Login with your credentials on the secure server")}),e.jsx("li",{children:t("You will be automatically redirected back and logged in")})]})]})]})}),e.jsx("div",{className:"mb-3 text-center",children:e.jsx(w,{variant:"primary",size:"lg",onClick:d,disabled:r,className:"px-5",children:r?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),t("Redirecting...")]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"mdi mdi-shield-lock-outline me-2"}),t("Login with Identity Server")]})})}),e.jsxs("div",{className:"text-center mt-4",children:[e.jsxs("p",{className:"text-muted mb-2",style:{fontSize:"0.875rem"},children:[e.jsx("i",{className:"mdi mdi-check-circle text-success me-1"}),t("Secured with OAuth 2.0 + PKCE")]}),e.jsxs("p",{className:"text-muted mb-0",style:{fontSize:"0.875rem"},children:[e.jsx("i",{className:"mdi mdi-server text-primary me-1"}),t("Server"),": identity.dev.usta.vn"]})]})]})]})}export{O as default};
