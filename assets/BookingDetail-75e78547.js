import{bu as v,a as k,j as e,P as o,d as n,f as r,h as a,aW as t}from"./index-038953f0.js";import{u as B}from"./index-8da3f596.js";import{u as w}from"./useProducts-3b3f389d.js";import{A as g}from"./Alert-bc52e707.js";import{S as y}from"./Spinner-e48ef451.js";import{B as b}from"./Button-3bfbac80.js";import{T as D}from"./Table-758e605c.js";import"./useQuery-7bedfd01.js";import"./useMutation-b744f206.js";import"./ButtonGroup-57d351b1.js";import"./Modal-7d1d46c4.js";const H=()=>{const{id:c}=v(),m=k();console.log("[BookingDetail] Component rendered"),console.log("[BookingDetail] useParams id:",c),console.log("[BookingDetail] window.location:",window.location.pathname);const x=B(c||""),{data:s,isLoading:h,error:j}=x,{data:N=[]}=w();if(console.log("[BookingDetail] Hook state:",{booking:s,isLoading:h,error:j,isFetching:x.isFetching,isError:x.isError}),!c)return e.jsxs(e.Fragment,{children:[e.jsx(o,{title:"Booking Detail",subName:"Apps"}),e.jsx(g,{variant:"danger",children:"Booking ID is required"})]});const f=l=>{if(typeof l=="number")switch(l){case 1:return e.jsx(t,{bg:"info",children:"Created"});case 2:return e.jsx(t,{bg:"primary",children:"Assigned"});case 3:return e.jsx(t,{bg:"warning",children:"In Progress"});case 4:return e.jsx(t,{bg:"success",children:"Done"});case 5:return e.jsx(t,{bg:"danger",children:"Failed"});case 6:return e.jsx(t,{bg:"secondary",children:"Cancelled"});default:return e.jsxs(t,{bg:"secondary",children:["Status ",l]})}return e.jsx(t,{bg:"info",children:l||"Unknown"})},u=l=>N.find(d=>d.id===l);return h?e.jsxs(e.Fragment,{children:[e.jsx(o,{title:"Booking Detail",subName:"Apps"}),e.jsxs("div",{className:"text-center py-5",children:[e.jsx(y,{animation:"border",variant:"primary"}),e.jsx("p",{className:"mt-2",children:"Loading booking details..."})]})]}):j?e.jsxs(e.Fragment,{children:[e.jsx(o,{title:"Booking Detail",subName:"Apps"}),e.jsxs(g,{variant:"danger",children:[e.jsx("h5",{children:"Failed to load booking"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Error:"})," ",j.message]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Booking ID:"})," ",c]}),e.jsx(b,{variant:"secondary",onClick:()=>m("/apps/booking"),className:"mt-2",children:"Back to Bookings"})]})]}):!h&&!s?e.jsxs(e.Fragment,{children:[e.jsx(o,{title:"Booking Detail",subName:"Apps"}),e.jsxs(g,{variant:"warning",children:[e.jsx("h5",{children:"Booking not found"}),e.jsxs("p",{children:["No booking found with ID: ",c]}),e.jsx(b,{variant:"secondary",onClick:()=>m("/apps/booking"),className:"mt-2",children:"Back to Bookings"})]})]}):s?e.jsxs(e.Fragment,{children:[e.jsx(o,{title:"Booking Detail",subName:"Apps"}),e.jsx(n,{children:e.jsxs(r,{xs:12,children:[e.jsx("div",{className:"mb-3",children:e.jsxs(b,{variant:"secondary",onClick:()=>m("/apps/booking"),children:[e.jsx("i",{className:"mdi mdi-arrow-left me-1"})," Back to Bookings"]})}),e.jsxs(a,{className:"mb-3",children:[e.jsx(a.Header,{children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsx("h4",{className:"mb-0",children:"Booking Information"}),f(s.status)]})}),e.jsxs(a.Body,{children:[e.jsxs(n,{children:[e.jsx(r,{md:6,children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label fw-bold text-muted",children:"Booking ID"}),e.jsx("div",{className:"form-control-plaintext",children:e.jsx("code",{children:s.id})})]})}),e.jsx(r,{md:6,children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label fw-bold text-muted",children:"Booking Time"}),e.jsx("div",{className:"form-control-plaintext",children:new Date(s.bookingTime).toLocaleString("vi-VN",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})})]})})]}),e.jsx("hr",{}),e.jsxs(n,{children:[e.jsx(r,{md:6,children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label fw-bold text-muted",children:"Customer Name"}),e.jsx("div",{className:"form-control-plaintext",children:s.customerName||e.jsx("span",{className:"text-muted",children:"Not provided"})})]})}),e.jsx(r,{md:6,children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label fw-bold text-muted",children:"Customer Phone"}),e.jsx("div",{className:"form-control-plaintext",children:s.customerPhone||e.jsx("span",{className:"text-muted",children:"-"})})]})})]}),s.customerId&&e.jsx(n,{children:e.jsx(r,{md:6,children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label fw-bold text-muted",children:"Customer ID"}),e.jsx("div",{className:"form-control-plaintext",children:e.jsx("code",{children:s.customerId})})]})})}),e.jsx("hr",{}),e.jsx(n,{children:e.jsx(r,{md:12,children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label fw-bold text-muted",children:"Address"}),e.jsx("div",{className:"form-control-plaintext",children:s.address||e.jsx("span",{className:"text-muted",children:"Not provided"})})]})})}),s.latitude!==void 0&&s.longitude!==void 0&&e.jsx(n,{children:e.jsx(r,{md:6,children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label fw-bold text-muted",children:"Coordinates"}),e.jsx("div",{className:"form-control-plaintext",children:e.jsxs("small",{children:["Latitude: ",s.latitude.toFixed(6),", Longitude: ",s.longitude.toFixed(6)]})})]})})})]})]}),s.items&&s.items.length>0&&e.jsxs(a,{className:"mb-3",children:[e.jsx(a.Header,{children:e.jsx("h4",{className:"mb-0",children:"Booking Items"})}),e.jsx(a.Body,{children:e.jsxs(D,{hover:!0,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Product"}),e.jsx("th",{children:"Price"}),e.jsx("th",{children:"Quantity"}),e.jsx("th",{children:"Subtotal"})]})}),e.jsx("tbody",{children:s.items.map((l,d)=>{const i=u(l.productId),p=((i==null?void 0:i.price)||0)*l.quantity;return e.jsxs("tr",{children:[e.jsxs("td",{children:[e.jsx("strong",{children:(i==null?void 0:i.name)||l.productId}),(i==null?void 0:i.description)&&e.jsx("div",{className:"text-muted small",children:i.description})]}),e.jsx("td",{children:i!=null&&i.price?e.jsxs(e.Fragment,{children:[i.price.toLocaleString("vi-VN")," VND"]}):e.jsx("span",{className:"text-muted",children:"N/A"})}),e.jsx("td",{children:e.jsx(t,{bg:"info",children:l.quantity})}),e.jsx("td",{children:e.jsxs("strong",{children:[p.toLocaleString("vi-VN")," VND"]})})]},d)})}),e.jsx("tfoot",{children:e.jsxs("tr",{children:[e.jsx("td",{colSpan:3,className:"text-end fw-bold",children:"Total Price:"}),e.jsx("td",{className:"fw-bold",children:s.totalPrice?e.jsxs(e.Fragment,{children:[s.totalPrice.toLocaleString("vi-VN")," VND"]}):e.jsxs(e.Fragment,{children:[s.items.reduce((l,d)=>{const i=u(d.productId);return l+((i==null?void 0:i.price)||0)*d.quantity},0).toLocaleString("vi-VN")," ","VND"]})})]})})]})})]}),e.jsxs(a,{children:[e.jsx(a.Header,{children:e.jsx("h4",{className:"mb-0",children:"Additional Information"})}),e.jsxs(a.Body,{children:[e.jsxs(n,{children:[s.createdBy&&e.jsx(r,{md:6,children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label fw-bold text-muted",children:"Created By"}),e.jsx("div",{className:"form-control-plaintext",children:e.jsx("code",{children:s.createdBy})})]})}),s.technicianId&&e.jsx(r,{md:6,children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label fw-bold text-muted",children:"Technician ID"}),e.jsx("div",{className:"form-control-plaintext",children:e.jsx("code",{children:s.technicianId})})]})})]}),e.jsxs(n,{children:[s.createdAt&&e.jsx(r,{md:6,children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label fw-bold text-muted",children:"Created At"}),e.jsx("div",{className:"form-control-plaintext",children:new Date(s.createdAt).toLocaleString("vi-VN")})]})}),s.updatedAt&&e.jsx(r,{md:6,children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label fw-bold text-muted",children:"Updated At"}),e.jsx("div",{className:"form-control-plaintext",children:new Date(s.updatedAt).toLocaleString("vi-VN")})]})})]}),s.totalPrice&&e.jsx(n,{children:e.jsx(r,{md:6,children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label fw-bold text-muted",children:"Total Price"}),e.jsx("div",{className:"form-control-plaintext",children:e.jsxs("h5",{className:"mb-0 text-primary",children:[s.totalPrice.toLocaleString("vi-VN")," VND"]})})]})})})]})]})]})})]}):null};export{H as default};
