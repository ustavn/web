import{j as e,r as c,P as y,d as b,f as v,h as C,aa as N}from"./index-64b55cb4.js";import{S}from"./react-select.esm-b46f0e70.js";import{u as L,a as I}from"./useCategories-8195f053.js";import{B as g}from"./Badge-114e085a.js";import{B as d}from"./Button-fd762df4.js";import{A as M}from"./Alert-f161e921.js";import{S as P}from"./Spinner-a1d2bbfc.js";import{M as i}from"./Modal-0ade13d1.js";import{F as r}from"./Form-af4b6af5.js";import"./hook-faf4790a.js";import"./useQuery-419e495e.js";import"./useMutation-b6c6e57b.js";import"./AbstractModalHeader-f1d869ae.js";import"./useWindow-7982fea9.js";import"./hasClass-d3812cb5.js";import"./useMergedRefs-9644369a.js";import"./DataKey-e12315fd.js";import"./ElementChildren-3d5bbd53.js";const w=[{Header:"ID",accessor:"id",defaultCanSort:!1,Cell:({value:a})=>e.jsxs("small",{className:"text-muted",children:[a.substring(0,8),"..."]})},{Header:"Code",accessor:"code",defaultCanSort:!0,Cell:({value:a})=>e.jsx(g,{bg:"primary",children:a})},{Header:"Name",accessor:"name",defaultCanSort:!0,Cell:({value:a})=>e.jsx("strong",{children:a})},{Header:"Level Code",accessor:"levelCode",defaultCanSort:!0,Cell:({value:a})=>e.jsx(g,{bg:"secondary",children:a})},{Header:"Parent ID",accessor:"parentId",defaultCanSort:!1,Cell:({value:a})=>a?e.jsxs("small",{className:"text-muted",children:[a.substring(0,8),"..."]}):e.jsx("span",{className:"text-muted",children:"—"})},{Header:"Description",accessor:"description",defaultCanSort:!1,Cell:({value:a})=>e.jsx("span",{className:"text-muted",children:a||"—"})},{Header:"Created At",accessor:"createdAt",defaultCanSort:!0,Cell:({value:a})=>new Date(a).toLocaleDateString()}],D=[{text:"10",value:10},{text:"25",value:25},{text:"50",value:50}],H=()=>{const[a,l]=c.useState(!1),[s,o]=c.useState({parentId:null,name:"",code:"",description:null}),{data:n,isLoading:x,error:m}=L(),u=I(),p=c.useMemo(()=>n?n.map(t=>({value:t.id,label:`${t.code} - ${t.name}`})):[],[n]),j=c.useMemo(()=>s.parentId&&p.find(t=>t.value===s.parentId)||null,[s.parentId,p]),f=async t=>{t.preventDefault();try{const h={...s,parentId:s.parentId||null,description:s.description||null};await u.mutateAsync(h),l(!1),o({parentId:null,name:"",code:"",description:null})}catch{}};return e.jsxs(e.Fragment,{children:[e.jsx(y,{title:"Categories",subName:"Apps"}),e.jsx(b,{children:e.jsx(v,{xs:12,children:e.jsx(C,{children:e.jsxs(C.Body,{children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[e.jsx("h4",{className:"header-title",children:"Categories List"}),e.jsxs(d,{variant:"primary",onClick:()=>l(!0),children:[e.jsx("i",{className:"mdi mdi-plus-circle me-1"}),"Create Category"]})]}),m&&e.jsxs(M,{variant:"danger",children:[e.jsx("strong",{children:"Error:"})," ",m instanceof Error?m.message:"Failed to load categories"]}),x?e.jsxs("div",{className:"text-center py-5",children:[e.jsx(P,{animation:"border",variant:"primary"}),e.jsx("p",{className:"mt-2",children:"Loading categories..."})]}):n&&n.length>0?e.jsx(N,{columns:w,data:n,pageSize:10,sizePerPageList:D,isSortable:!0,pagination:!0,isSearchable:!0}):e.jsxs("div",{className:"text-center py-5",children:[e.jsx("p",{className:"text-muted",children:"No categories found"}),e.jsx(d,{variant:"primary",onClick:()=>l(!0),children:"Create First Category"})]})]})})})}),e.jsxs(i,{show:a,onHide:()=>l(!1),children:[e.jsx(i.Header,{closeButton:!0,children:e.jsx(i.Title,{children:"Create New Category"})}),e.jsxs(r,{onSubmit:f,children:[e.jsxs(i.Body,{children:[e.jsxs(r.Group,{className:"mb-3",children:[e.jsx(r.Label,{children:"Category Name *"}),e.jsx(r.Control,{type:"text",placeholder:"Enter category name",value:s.name,onChange:t=>o({...s,name:t.target.value}),required:!0})]}),e.jsxs(r.Group,{className:"mb-3",children:[e.jsx(r.Label,{children:"Category Code *"}),e.jsx(r.Control,{type:"text",placeholder:"e.g., LM",value:s.code,onChange:t=>o({...s,code:t.target.value}),required:!0}),e.jsx(r.Text,{className:"text-muted",children:"Short code to identify this category"})]}),e.jsxs(r.Group,{className:"mb-3",children:[e.jsx(r.Label,{children:"Parent Category (Optional)"}),e.jsx(S,{className:"react-select",classNamePrefix:"react-select",placeholder:"Search and select a parent category...",isClearable:!0,isSearchable:!0,options:p,value:j,onChange:t=>{o({...s,parentId:t?t.value:null})},noOptionsMessage:()=>"No categories found",isLoading:x}),e.jsx(r.Text,{className:"text-muted",children:"Leave empty for root level category"})]}),e.jsxs(r.Group,{className:"mb-3",children:[e.jsx(r.Label,{children:"Description (Optional)"}),e.jsx(r.Control,{as:"textarea",rows:2,placeholder:"Enter description",value:s.description||"",onChange:t=>o({...s,description:t.target.value||null})})]})]}),e.jsxs(i.Footer,{children:[e.jsx(d,{variant:"secondary",onClick:()=>l(!1),children:"Cancel"}),e.jsx(d,{variant:"primary",type:"submit",disabled:u.isPending,children:u.isPending?"Creating...":"Create Category"})]})]})]})]})},X=()=>e.jsx(H,{});export{X as default};
