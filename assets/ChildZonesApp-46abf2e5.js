import{bw as Z,a as A,r as m,j as e,P as B,d as p,f as C,h as g,v as a,aW as v}from"./index-b28ba44c.js";import{u as D,a as k,b as F}from"./index-0e277251.js";import{B as n}from"./Button-31e96e58.js";import{A as P}from"./Alert-1b0c81c4.js";import{S as M}from"./Spinner-9d2d648a.js";import{T}from"./Table-e504dee2.js";import{M as i}from"./Modal-739a33da.js";import"./useQuery-3baf8eda.js";import"./useMutation-97f0dbcf.js";const W=()=>{const{parentId:d}=Z(),x=A(),[c,b]=m.useState(""),[f,o]=m.useState(!1),[r,l]=m.useState({name:"",code:"",description:""}),{data:t,isLoading:N}=D(d||""),{data:y=[],isLoading:w,error:j}=k({parentId:d}),h=F(),u=y.filter(s=>s.name.toLowerCase().includes(c.toLowerCase())||s.code.toLowerCase().includes(c.toLowerCase())),S=async s=>{if(s.preventDefault(),!!d)try{await h.mutateAsync({...r,parentId:d}),o(!1),l({name:"",code:"",description:""})}catch(L){console.error("Failed to create zone:",L)}};return e.jsxs(e.Fragment,{children:[e.jsx(B,{title:`Child Zones - ${(t==null?void 0:t.name)||"Loading..."}`,subName:"Apps"}),e.jsx(p,{children:e.jsx(C,{xs:12,children:e.jsx(g,{children:e.jsxs(g.Body,{children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[e.jsxs("div",{children:[e.jsxs(n,{variant:"link",onClick:()=>x("/apps/zones"),className:"p-0 mb-2",children:[e.jsx("i",{className:"mdi mdi-arrow-left me-1"}),"Back to Zones"]}),t&&e.jsx("div",{children:e.jsxs("h5",{className:"mb-0",children:["Child Zones of: ",e.jsx("strong",{children:t.name})," (",t.code,")"]})})]}),e.jsxs(n,{variant:"primary",onClick:()=>o(!0),children:[e.jsx("i",{className:"uil uil-plus me-1"})," Create Child Zone"]})]}),e.jsx(p,{className:"mb-3",children:e.jsx(C,{md:6,children:e.jsx(a.Control,{type:"text",placeholder:"Search zones...",value:c,onChange:s=>b(s.target.value)})})}),j&&e.jsxs(P,{variant:"danger",dismissible:!0,children:["Failed to load zones: ",j.message]}),w||N?e.jsx("div",{className:"text-center py-5",children:e.jsx(M,{animation:"border",variant:"primary"})}):e.jsxs(T,{hover:!0,responsive:!0,children:[e.jsx("thead",{className:"table-light",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Code"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Description"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Created At"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:u.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"text-center py-4 text-muted",children:"No child zones found"})}):u.map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("strong",{children:s.code})}),e.jsx("td",{children:s.name}),e.jsx("td",{children:s.description||"-"}),e.jsx("td",{children:s.isActive!==void 0?s.isActive?e.jsx(v,{bg:"success",children:"Active"}):e.jsx(v,{bg:"secondary",children:"Inactive"}):e.jsx("span",{className:"text-muted",children:"-"})}),e.jsx("td",{children:new Date(s.createdAt).toLocaleDateString("vi-VN")}),e.jsx("td",{children:s.id&&e.jsx(n,{variant:"info",size:"sm",onClick:()=>x(`/apps/zones/${s.id}/children`),children:"View Children"})})]},s.id))})]})]})})})}),e.jsxs(i,{show:f,onHide:()=>o(!1),children:[e.jsx(i.Header,{closeButton:!0,children:e.jsx(i.Title,{children:"Create New Child Zone"})}),e.jsxs(a,{onSubmit:S,children:[e.jsxs(i.Body,{children:[e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Zone Code *"}),e.jsx(a.Control,{type:"text",placeholder:"Q5",value:r.code,onChange:s=>l({...r,code:s.target.value}),required:!0})]}),e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Zone Name *"}),e.jsx(a.Control,{type:"text",placeholder:"Quan 5",value:r.name,onChange:s=>l({...r,name:s.target.value}),required:!0})]}),e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Description"}),e.jsx(a.Control,{as:"textarea",rows:3,placeholder:"trung tam tp",value:r.description,onChange:s=>l({...r,description:s.target.value})})]})]}),e.jsxs(i.Footer,{children:[e.jsx(n,{variant:"secondary",onClick:()=>o(!1),children:"Cancel"}),e.jsx(n,{variant:"primary",type:"submit",disabled:h.isPending,children:h.isPending?"Creating...":"Create Zone"})]})]})]})]})};export{W as default};
