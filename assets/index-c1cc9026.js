import{a as _,r as t,j as e,P as k,d as g,f as x,h as y,_ as f,R as D,c as j}from"./index-f24fabb9.js";import{u as P,a as M}from"./useZones-ffad92a7.js";import{F as r}from"./Form-93705b7c.js";import{B as d}from"./Button-1bd665f7.js";import{A as B}from"./Alert-f3b59418.js";import{S as u}from"./Spinner-c6839ba2.js";import{T as E}from"./Table-80d353f7.js";import{B as b}from"./Badge-41b97b48.js";import{M as o}from"./Modal-4d26d06f.js";import"./useQuery-ef7bc5d7.js";import"./useMutation-bf1cb67e.js";import"./ElementChildren-33f86963.js";import"./hook-c08bc9e4.js";import"./AbstractModalHeader-5af54cd0.js";import"./useWindow-e030e9b1.js";import"./hasClass-2aefdf69.js";import"./useMergedRefs-cc67f583.js";import"./DataKey-e12315fd.js";const F=()=>{const a=_(),[m,N]=t.useState(""),[S,l]=t.useState(!1),[n,c]=t.useState({name:"",code:"",description:""}),{data:h=[],isLoading:Z,error:C}=P(),p=M(),v=h.filter(s=>s.name.toLowerCase().includes(m.toLowerCase())||s.code.toLowerCase().includes(m.toLowerCase())),A=t.useMemo(()=>{const s=new Map;return h.forEach(i=>{s.set(i.id,i.name)}),s},[h]),w=s=>s?A.get(s)||s:"-",L=async s=>{s.preventDefault();try{await p.mutateAsync(n),l(!1),c({name:"",code:"",description:""})}catch{}};return e.jsxs(e.Fragment,{children:[e.jsx(k,{title:"Zone Management",subName:"Apps"}),e.jsx(g,{children:e.jsx(x,{xs:12,children:e.jsx(y,{children:e.jsxs(y.Body,{children:[e.jsxs(g,{className:"mb-3",children:[e.jsx(x,{md:6,children:e.jsx(r.Control,{type:"text",placeholder:"Search zones...",value:m,onChange:s=>N(s.target.value)})}),e.jsx(x,{md:6,className:"text-end",children:e.jsxs(d,{variant:"primary",onClick:()=>l(!0),children:[e.jsx("i",{className:"uil uil-plus me-1"})," Create Zone"]})})]}),C&&e.jsxs(B,{variant:"danger",dismissible:!0,children:["Failed to load zones: ",C.message]}),Z?e.jsx("div",{className:"text-center py-5",children:e.jsx(u,{animation:"border",variant:"primary"})}):e.jsxs(E,{hover:!0,responsive:!0,children:[e.jsx("thead",{className:"table-light",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Code"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Description"}),e.jsx("th",{children:"Parent Zone"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Created At"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:v.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"text-center py-4 text-muted",children:"No zones found"})}):v.map(s=>e.jsxs("tr",{children:[e.jsx("td",{style:{cursor:"pointer"},onClick:()=>a(`/apps/zones/${s.id}/children`),children:e.jsx("strong",{children:s.code})}),e.jsx("td",{style:{cursor:"pointer"},onClick:()=>a(`/apps/zones/${s.id}/children`),children:s.name}),e.jsx("td",{style:{cursor:"pointer"},onClick:()=>a(`/apps/zones/${s.id}/children`),children:s.description||"-"}),e.jsx("td",{style:{cursor:"pointer"},onClick:()=>a(`/apps/zones/${s.id}/children`),children:w(s.parentId)}),e.jsx("td",{style:{cursor:"pointer"},onClick:()=>a(`/apps/zones/${s.id}/children`),children:s.isActive!==void 0?s.isActive?e.jsx(b,{bg:"success",children:"Active"}):e.jsx(b,{bg:"secondary",children:"Inactive"}):e.jsx("span",{className:"text-muted",children:"-"})}),e.jsx("td",{style:{cursor:"pointer"},onClick:()=>a(`/apps/zones/${s.id}/children`),children:new Date(s.createdAt).toLocaleDateString("vi-VN")}),e.jsx("td",{children:e.jsxs(d,{variant:"primary",size:"sm",onClick:i=>{i.stopPropagation(),a(`/apps/zones/${s.id}`)},children:[e.jsx("i",{className:"mdi mdi-map-marker-path me-1"}),"Geo Fence"]})})]},s.id))})]})]})})})}),e.jsxs(o,{show:S,onHide:()=>l(!1),children:[e.jsx(o.Header,{closeButton:!0,children:e.jsx(o.Title,{children:"Create New Zone"})}),e.jsxs(r,{onSubmit:L,children:[e.jsxs(o.Body,{children:[e.jsxs(r.Group,{className:"mb-3",children:[e.jsx(r.Label,{children:"Zone Code *"}),e.jsx(r.Control,{type:"text",placeholder:"Q5",value:n.code,onChange:s=>c({...n,code:s.target.value}),required:!0})]}),e.jsxs(r.Group,{className:"mb-3",children:[e.jsx(r.Label,{children:"Zone Name *"}),e.jsx(r.Control,{type:"text",placeholder:"Quan 5",value:n.name,onChange:s=>c({...n,name:s.target.value}),required:!0})]}),e.jsxs(r.Group,{className:"mb-3",children:[e.jsx(r.Label,{children:"Description"}),e.jsx(r.Control,{as:"textarea",rows:3,placeholder:"trung tam tp",value:n.description,onChange:s=>c({...n,description:s.target.value})})]})]}),e.jsxs(o.Footer,{children:[e.jsx(d,{variant:"secondary",onClick:()=>l(!1),children:"Cancel"}),e.jsx(d,{variant:"primary",type:"submit",disabled:p.isPending,children:p.isPending?"Creating...":"Create Zone"})]})]})]})]})},R=t.lazy(()=>f(()=>import("./ChildZonesApp-bcf1494b.js"),["assets/ChildZonesApp-bcf1494b.js","assets/index-f24fabb9.js","assets/index-6054c063.css","assets/useZones-ffad92a7.js","assets/useQuery-ef7bc5d7.js","assets/useMutation-bf1cb67e.js","assets/Button-1bd665f7.js","assets/Spinner-c6839ba2.js","assets/Badge-41b97b48.js","assets/Alert-f3b59418.js","assets/hook-c08bc9e4.js","assets/Form-93705b7c.js","assets/ElementChildren-33f86963.js","assets/Table-80d353f7.js","assets/Modal-4d26d06f.js","assets/AbstractModalHeader-5af54cd0.js","assets/useWindow-e030e9b1.js","assets/hasClass-2aefdf69.js","assets/useMergedRefs-cc67f583.js","assets/DataKey-e12315fd.js"])),T=t.lazy(()=>f(()=>import("./ZoneDetail-a3fa06d4.js"),["assets/ZoneDetail-a3fa06d4.js","assets/index-f24fabb9.js","assets/index-6054c063.css","assets/useZones-ffad92a7.js","assets/useQuery-ef7bc5d7.js","assets/useMutation-bf1cb67e.js","assets/Alert-f3b59418.js","assets/hook-c08bc9e4.js","assets/Spinner-c6839ba2.js","assets/Button-1bd665f7.js","assets/Badge-41b97b48.js"])),te=()=>e.jsxs(D,{children:[e.jsx(j,{index:!0,element:e.jsx(F,{})}),e.jsx(j,{path:":parentId/children",element:e.jsx(t.Suspense,{fallback:e.jsxs("div",{className:"text-center py-5",children:[e.jsx(u,{animation:"border",variant:"primary"}),e.jsx("p",{className:"mt-2",children:"Loading..."})]}),children:e.jsx(R,{})})}),e.jsx(j,{path:":id",element:e.jsx(t.Suspense,{fallback:e.jsxs("div",{className:"text-center py-5",children:[e.jsx(u,{animation:"border",variant:"primary"}),e.jsx("p",{className:"mt-2",children:"Loading zone details..."})]}),children:e.jsx(T,{})})})]});export{te as default};
