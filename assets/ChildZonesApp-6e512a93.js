import{aX as Z,a as A,r as m,j as e,P as B,d as u,f as C,h as g}from"./index-7abc2e1c.js";import{u as D,a as F,b as k}from"./index-7c6b7e8b.js";import{B as i}from"./Button-98115848.js";import{F as r}from"./Form-3dd09149.js";import{A as P}from"./Alert-970a7765.js";import{S as M}from"./Spinner-f490c646.js";import{T}from"./Table-2e1e6572.js";import{B as v}from"./Badge-f7a378fe.js";import{M as n}from"./Modal-d1b37a71.js";import"./useQuery-fef0428f.js";import"./useMutation-04d1b243.js";import"./FormControl-92329ab5.js";import"./ElementChildren-dbbb72ab.js";import"./hook-87ee9a06.js";import"./AbstractModalHeader-b51e44f5.js";import"./useWindow-25e16477.js";import"./hasClass-d6dc9e47.js";import"./useMergedRefs-c0c7f279.js";import"./DataKey-e12315fd.js";const se=()=>{const{parentId:o}=Z(),x=A(),[c,f]=m.useState(""),[b,d]=m.useState(!1),[t,l]=m.useState({name:"",code:"",description:""}),{data:a,isLoading:N}=D(o||""),{data:y=[],isLoading:w,error:j}=F({parentId:o}),h=k(),p=y.filter(s=>s.name.toLowerCase().includes(c.toLowerCase())||s.code.toLowerCase().includes(c.toLowerCase())),S=async s=>{if(s.preventDefault(),!!o)try{await h.mutateAsync({...t,parentId:o}),d(!1),l({name:"",code:"",description:""})}catch(L){console.error("Failed to create zone:",L)}};return e.jsxs(e.Fragment,{children:[e.jsx(B,{title:`Child Zones - ${(a==null?void 0:a.name)||"Loading..."}`,subName:"Apps"}),e.jsx(u,{children:e.jsx(C,{xs:12,children:e.jsx(g,{children:e.jsxs(g.Body,{children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[e.jsxs("div",{children:[e.jsxs(i,{variant:"link",onClick:()=>x("/apps/zones"),className:"p-0 mb-2",children:[e.jsx("i",{className:"mdi mdi-arrow-left me-1"}),"Back to Zones"]}),a&&e.jsx("div",{children:e.jsxs("h5",{className:"mb-0",children:["Child Zones of: ",e.jsx("strong",{children:a.name})," (",a.code,")"]})})]}),e.jsxs(i,{variant:"primary",onClick:()=>d(!0),children:[e.jsx("i",{className:"uil uil-plus me-1"})," Create Child Zone"]})]}),e.jsx(u,{className:"mb-3",children:e.jsx(C,{md:6,children:e.jsx(r.Control,{type:"text",placeholder:"Search zones...",value:c,onChange:s=>f(s.target.value)})})}),j&&e.jsxs(P,{variant:"danger",dismissible:!0,children:["Failed to load zones: ",j.message]}),w||N?e.jsx("div",{className:"text-center py-5",children:e.jsx(M,{animation:"border",variant:"primary"})}):e.jsxs(T,{hover:!0,responsive:!0,children:[e.jsx("thead",{className:"table-light",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Code"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Description"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Created At"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:p.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"text-center py-4 text-muted",children:"No child zones found"})}):p.map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("strong",{children:s.code})}),e.jsx("td",{children:s.name}),e.jsx("td",{children:s.description||"-"}),e.jsx("td",{children:s.isActive!==void 0?s.isActive?e.jsx(v,{bg:"success",children:"Active"}):e.jsx(v,{bg:"secondary",children:"Inactive"}):e.jsx("span",{className:"text-muted",children:"-"})}),e.jsx("td",{children:new Date(s.createdAt).toLocaleDateString("vi-VN")}),e.jsx("td",{children:s.id&&e.jsx(i,{variant:"info",size:"sm",onClick:()=>x(`/apps/zones/${s.id}/children`),children:"View Children"})})]},s.id))})]})]})})})}),e.jsxs(n,{show:b,onHide:()=>d(!1),children:[e.jsx(n.Header,{closeButton:!0,children:e.jsx(n.Title,{children:"Create New Child Zone"})}),e.jsxs(r,{onSubmit:S,children:[e.jsxs(n.Body,{children:[e.jsxs(r.Group,{className:"mb-3",children:[e.jsx(r.Label,{children:"Zone Code *"}),e.jsx(r.Control,{type:"text",placeholder:"Q5",value:t.code,onChange:s=>l({...t,code:s.target.value}),required:!0})]}),e.jsxs(r.Group,{className:"mb-3",children:[e.jsx(r.Label,{children:"Zone Name *"}),e.jsx(r.Control,{type:"text",placeholder:"Quan 5",value:t.name,onChange:s=>l({...t,name:s.target.value}),required:!0})]}),e.jsxs(r.Group,{className:"mb-3",children:[e.jsx(r.Label,{children:"Description"}),e.jsx(r.Control,{as:"textarea",rows:3,placeholder:"trung tam tp",value:t.description,onChange:s=>l({...t,description:s.target.value})})]})]}),e.jsxs(n.Footer,{children:[e.jsx(i,{variant:"secondary",onClick:()=>d(!1),children:"Cancel"}),e.jsx(i,{variant:"primary",type:"submit",disabled:h.isPending,children:h.isPending?"Creating...":"Create Zone"})]})]})]})]})};export{se as default};
