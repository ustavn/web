import{j as e,aW as C,r as c,P as y,d as b,f as v,h as g,bn as N,v as r}from"./index-b28ba44c.js";import{S}from"./react-select.esm-5ede1760.js";import{u as L,a as I}from"./useCategories-6c206434.js";import{B as d}from"./Button-31e96e58.js";import{A as M}from"./Alert-1b0c81c4.js";import{S as P}from"./Spinner-9d2d648a.js";import{M as i}from"./Modal-739a33da.js";import"./objectSpread2-0f1cd81b.js";import"./useQuery-3baf8eda.js";import"./useMutation-97f0dbcf.js";const w=[{Header:"ID",accessor:"id",defaultCanSort:!1,Cell:({value:a})=>e.jsxs("small",{className:"text-muted",children:[a.substring(0,8),"..."]})},{Header:"Code",accessor:"code",defaultCanSort:!0,Cell:({value:a})=>e.jsx(C,{bg:"primary",children:a})},{Header:"Name",accessor:"name",defaultCanSort:!0,Cell:({value:a})=>e.jsx("strong",{children:a})},{Header:"Level Code",accessor:"levelCode",defaultCanSort:!0,Cell:({value:a})=>e.jsx(C,{bg:"secondary",children:a})},{Header:"Parent ID",accessor:"parentId",defaultCanSort:!1,Cell:({value:a})=>a?e.jsxs("small",{className:"text-muted",children:[a.substring(0,8),"..."]}):e.jsx("span",{className:"text-muted",children:"—"})},{Header:"Description",accessor:"description",defaultCanSort:!1,Cell:({value:a})=>e.jsx("span",{className:"text-muted",children:a||"—"})},{Header:"Created At",accessor:"createdAt",defaultCanSort:!0,Cell:({value:a})=>new Date(a).toLocaleDateString()}],D=[{text:"10",value:10},{text:"25",value:25},{text:"50",value:50}],H=()=>{const[a,l]=c.useState(!1),[s,o]=c.useState({parentId:null,name:"",code:"",description:null}),{data:n,isLoading:h,error:u}=L(),m=I(),x=c.useMemo(()=>n?n.map(t=>({value:t.id,label:`${t.code} - ${t.name}`})):[],[n]),j=c.useMemo(()=>s.parentId&&x.find(t=>t.value===s.parentId)||null,[s.parentId,x]),f=async t=>{t.preventDefault();try{const p={...s,parentId:s.parentId||null,description:s.description||null};await m.mutateAsync(p),l(!1),o({parentId:null,name:"",code:"",description:null})}catch(p){console.error("Failed to create category:",p)}};return e.jsxs(e.Fragment,{children:[e.jsx(y,{title:"Categories",subName:"Apps"}),e.jsx(b,{children:e.jsx(v,{xs:12,children:e.jsx(g,{children:e.jsxs(g.Body,{children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[e.jsx("h4",{className:"header-title",children:"Categories List"}),e.jsxs(d,{variant:"primary",onClick:()=>l(!0),children:[e.jsx("i",{className:"mdi mdi-plus-circle me-1"}),"Create Category"]})]}),u&&e.jsxs(M,{variant:"danger",children:[e.jsx("strong",{children:"Error:"})," ",u instanceof Error?u.message:"Failed to load categories"]}),h?e.jsxs("div",{className:"text-center py-5",children:[e.jsx(P,{animation:"border",variant:"primary"}),e.jsx("p",{className:"mt-2",children:"Loading categories..."})]}):n&&n.length>0?e.jsx(N,{columns:w,data:n,pageSize:10,sizePerPageList:D,isSortable:!0,pagination:!0,isSearchable:!0}):e.jsxs("div",{className:"text-center py-5",children:[e.jsx("p",{className:"text-muted",children:"No categories found"}),e.jsx(d,{variant:"primary",onClick:()=>l(!0),children:"Create First Category"})]})]})})})}),e.jsxs(i,{show:a,onHide:()=>l(!1),children:[e.jsx(i.Header,{closeButton:!0,children:e.jsx(i.Title,{children:"Create New Category"})}),e.jsxs(r,{onSubmit:f,children:[e.jsxs(i.Body,{children:[e.jsxs(r.Group,{className:"mb-3",children:[e.jsx(r.Label,{children:"Category Name *"}),e.jsx(r.Control,{type:"text",placeholder:"Enter category name",value:s.name,onChange:t=>o({...s,name:t.target.value}),required:!0})]}),e.jsxs(r.Group,{className:"mb-3",children:[e.jsx(r.Label,{children:"Category Code *"}),e.jsx(r.Control,{type:"text",placeholder:"e.g., LM",value:s.code,onChange:t=>o({...s,code:t.target.value}),required:!0}),e.jsx(r.Text,{className:"text-muted",children:"Short code to identify this category"})]}),e.jsxs(r.Group,{className:"mb-3",children:[e.jsx(r.Label,{children:"Parent Category (Optional)"}),e.jsx(S,{className:"react-select",classNamePrefix:"react-select",placeholder:"Search and select a parent category...",isClearable:!0,isSearchable:!0,options:x,value:j,onChange:t=>{o({...s,parentId:t?t.value:null})},noOptionsMessage:()=>"No categories found",isLoading:h}),e.jsx(r.Text,{className:"text-muted",children:"Leave empty for root level category"})]}),e.jsxs(r.Group,{className:"mb-3",children:[e.jsx(r.Label,{children:"Description (Optional)"}),e.jsx(r.Control,{as:"textarea",rows:2,placeholder:"Enter description",value:s.description||"",onChange:t=>o({...s,description:t.target.value||null})})]})]}),e.jsxs(i.Footer,{children:[e.jsx(d,{variant:"secondary",onClick:()=>l(!1),children:"Cancel"}),e.jsx(d,{variant:"primary",type:"submit",disabled:m.isPending,children:m.isPending?"Creating...":"Create Category"})]})]})]})]})},z=()=>e.jsx(H,{});export{z as default};
