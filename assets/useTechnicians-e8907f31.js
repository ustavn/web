import{u}from"./useQuery-6c10f0fe.js";import{a5 as y,a6 as h,ak as d}from"./index-f2719a80.js";import{u as p}from"./useMutation-2bc86ccc.js";const f="https://api.dev.usta.vn",o=y.create({baseURL:`${f}/api`,timeout:3e4,headers:{"Content-Type":"application/json"}});o.interceptors.request.use(async e=>{const t=localStorage.getItem("_USTA_OAUTH");if(t)try{const a=JSON.parse(t);e.headers.Authorization=`Bearer ${a.accessToken}`}catch{}return e},e=>Promise.reject(e));o.interceptors.response.use(e=>e,e=>Promise.reject(e));async function m(e={}){const t=await o.get("/technicians/",{params:e});if(t.data.success)return t.data.data;throw new Error(t.data.error||"Failed to fetch technicians")}async function l(e){const t=await o.get(`/technicians/${e}`);if(t.data&&typeof t.data=="object"&&"success"in t.data){const a=t.data;if(a.success&&a.data)return a.data;throw new Error(a.error||"Failed to fetch technician")}return t.data}async function g(e){var t,a,r,i;try{const{technicianId:n,...s}=e,c=await o.post(`/technicians/${n}/approve`,s);if(c.data.success&&c.data.data)return c.data.data;throw new Error(c.data.error||c.data.message||"Failed to approve technician")}catch(n){const s=((a=(t=n.response)==null?void 0:t.data)==null?void 0:a.error)||((i=(r=n.response)==null?void 0:r.data)==null?void 0:i.message)||n.message||"Failed to approve technician";throw new Error(s)}}async function w(e){var t,a,r,i;try{const{technicianId:n,reason:s}=e,c=await o.post(`/technicians/${n}/reject`,{reason:s});if(!c.data.success)throw new Error(c.data.error||c.data.message||"Failed to reject technician")}catch(n){const s=((a=(t=n.response)==null?void 0:t.data)==null?void 0:a.error)||((i=(r=n.response)==null?void 0:r.data)==null?void 0:i.message)||n.message||"Failed to reject technician";throw new Error(s)}}async function j(e,t={}){var a,r,i,n;try{const s=await o.post(`/technician-shifts/${e}`,t);if(s.data.success&&s.data.data)return s.data.data.items||[];throw new Error(s.data.error||"Failed to fetch technician shifts")}catch(s){const c=((r=(a=s.response)==null?void 0:a.data)==null?void 0:r.error)||((n=(i=s.response)==null?void 0:i.data)==null?void 0:n.message)||s.message||"Failed to fetch technician shifts";throw new Error(c)}}function v(e={}){return u({queryKey:["technicians",e],queryFn:()=>m(e),staleTime:3e4,retry:2,select:t=>t||[]})}function q(e){return u({queryKey:["technician",e],queryFn:()=>l(e),enabled:!!e,staleTime:3e4})}function S(){const e=h(),{showNotification:t}=d();return p({mutationFn:a=>g(a),onSuccess:()=>{e.invalidateQueries({queryKey:["technicians"]}),t({message:"Technician approved successfully",type:"success"})},onError:a=>{const r=(a==null?void 0:a.message)||"Failed to approve technician";t({message:r,type:"error"})}})}function C(){const e=h(),{showNotification:t}=d();return p({mutationFn:a=>w(a),onSuccess:()=>{e.invalidateQueries({queryKey:["technicians"]}),t({message:"Technician rejected successfully",type:"success"})},onError:a=>{const r=(a==null?void 0:a.message)||"Failed to reject technician";t({message:r,type:"error"})}})}export{q as a,S as b,C as c,j as g,v as u};
