import{j as e,bp as F,aZ as E,r as p,v as i,d as v,f as m,P as L,h as j}from"./index-b28ba44c.js";import{u as P}from"./useQuery-3baf8eda.js";import{u as w}from"./useMutation-97f0dbcf.js";import{S as y}from"./Spinner-9d2d648a.js";import{A as S}from"./Alert-1b0c81c4.js";import{L as f}from"./ListGroup-c96a6e22.js";const k=()=>e.jsxs("div",{children:[e.jsxs("h5",{className:"mb-4 text-uppercase",children:[e.jsx("i",{className:"mdi mdi-cog me-1"})," General Settings"]}),e.jsx("p",{className:"text-muted",children:"Settings coming soon..."})]});function A(){return P({queryKey:["booking-scan-settings"],queryFn:()=>F.getSettings(),staleTime:3e4,retry:2,select:n=>n||[]})}function D(){const n=E();return w({mutationFn:c=>F.saveSettings(c),onSuccess:()=>{n.invalidateQueries({queryKey:["booking-scan-settings"]})},onError:c=>{console.error("[useSaveBookingScanSettings] Failed to save settings:",c)}})}const I=()=>{const{data:n,isLoading:c,isError:b}=A(),l=D(),[t,N]=p.useState({radiusFirst:"1",radiusSecond:"1",radiusThird:"1",radiusFourth:"1",waitTime:"10"}),u=Array.from({length:15},(s,r)=>r+1).map(s=>({value:s.toString(),label:`${s} km`}));u.push({value:"all",label:"Tất cả"});const T=[5,10,15,20,25,30,35,40,45,50];p.useEffect(()=>{var s,r;if(n&&n.length>0){const a={waitTime:((r=(s=n[0])==null?void 0:s.scanIntervalMinutes)==null?void 0:r.toString())||"10"};n.forEach(x=>{const d=x.scanOrder,g=x.scanDistanceKm,o=g===-1?"all":g.toString();d===1&&(a.radiusFirst=o),d===2&&(a.radiusSecond=o),d===3&&(a.radiusThird=o),d===4&&(a.radiusFourth=o)}),N(x=>({...x,...a}))}},[n]);const h=(s,r)=>{N(a=>({...a,[s]:r}))},C=async s=>{s.preventDefault();const r=[1,2,3,4].map(a=>{const d=t[`radius${a===1?"First":a===2?"Second":a===3?"Third":"Fourth"}`],g=d==="all"?-1:parseFloat(d),o=parseInt(t.waitTime);return{scanDistanceKm:g,scanIntervalMinutes:o,scanOrder:a}});try{await l.mutateAsync(r)}catch(a){console.error("Failed to save settings:",a)}};return c?e.jsxs("div",{className:"text-center py-4",children:[e.jsx(y,{animation:"border",variant:"primary"}),e.jsx("p",{className:"mt-2 text-muted",children:"Loading settings..."})]}):e.jsxs(i,{onSubmit:C,children:[e.jsxs("h5",{className:"mb-4 text-uppercase",children:[e.jsx("i",{className:"mdi mdi-rocket-launch me-1"})," Job Push Engine Settings"]}),b&&e.jsx(S,{variant:"danger",className:"mb-3",children:"Failed to load settings. Please try again."}),l.isError&&e.jsx(S,{variant:"danger",className:"mb-3",children:"Failed to save settings. Please try again."}),l.isSuccess&&e.jsx(S,{variant:"success",className:"mb-3",children:"Settings saved successfully!"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h6",{className:"mb-2",children:"Radius"}),e.jsx("p",{className:"text-muted mb-3",children:"Cài đặt giá trị bán kính cho phép hệ thống quét tìm đối tác để đẩy job"}),e.jsxs(v,{children:[e.jsxs(m,{md:6,className:"mb-3",children:[e.jsx(i.Label,{children:"Lần đầu"}),e.jsx(i.Select,{name:"radiusFirst",value:t.radiusFirst,onChange:s=>h("radiusFirst",s.target.value),children:u.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]}),e.jsxs(m,{md:6,className:"mb-3",children:[e.jsx(i.Label,{children:"Lần 2"}),e.jsx(i.Select,{name:"radiusSecond",value:t.radiusSecond,onChange:s=>h("radiusSecond",s.target.value),children:u.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]})]}),e.jsxs(v,{children:[e.jsxs(m,{md:6,className:"mb-3",children:[e.jsx(i.Label,{children:"Lần 3"}),e.jsx(i.Select,{name:"radiusThird",value:t.radiusThird,onChange:s=>h("radiusThird",s.target.value),children:u.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]}),e.jsxs(m,{md:6,className:"mb-3",children:[e.jsx(i.Label,{children:"Lần 4"}),e.jsx(i.Select,{name:"radiusFourth",value:t.radiusFourth,onChange:s=>h("radiusFourth",s.target.value),children:u.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h6",{className:"mb-2",children:"Khoảng cách push"}),e.jsx("p",{className:"text-muted mb-3",children:"Thời gian chờ giữa các lần mở rộng bán kính quét"}),e.jsx(v,{children:e.jsxs(m,{md:6,className:"mb-3",children:[e.jsx(i.Label,{children:"Thời gian chờ"}),e.jsx(i.Select,{name:"waitTime",value:t.waitTime,onChange:s=>h("waitTime",s.target.value),children:T.map(s=>e.jsxs("option",{value:s,children:[s," Phút"]},s))})]})})]}),e.jsx("div",{className:"text-end",children:e.jsx("button",{type:"submit",className:"btn btn-success mt-2",disabled:l.isPending,children:l.isPending?e.jsxs(e.Fragment,{children:[e.jsx(y,{animation:"border",size:"sm",className:"me-2"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"mdi mdi-content-save"})," Save Changes"]})})})]})},q=()=>e.jsxs("div",{children:[e.jsxs("h5",{className:"mb-4 text-uppercase",children:[e.jsx("i",{className:"mdi mdi-delete me-1"})," Deleted Items Settings"]}),e.jsx("p",{className:"text-muted",children:"Settings coming soon..."})]}),B=()=>e.jsxs("div",{children:[e.jsxs("h5",{className:"mb-4 text-uppercase",children:[e.jsx("i",{className:"mdi mdi-email-alert me-1"})," Junk Emails Settings"]}),e.jsx("p",{className:"text-muted",children:"Settings coming soon..."})]}),J=()=>e.jsxs("div",{children:[e.jsxs("h5",{className:"mb-4 text-uppercase",children:[e.jsx("i",{className:"mdi mdi-archive me-1"})," Archive Settings"]}),e.jsx("p",{className:"text-muted",children:"Settings coming soon..."})]}),K=()=>e.jsxs("div",{children:[e.jsxs("h5",{className:"mb-4 text-uppercase",children:[e.jsx("i",{className:"mdi mdi-note-text me-1"})," Notes Settings"]}),e.jsx("p",{className:"text-muted",children:"Settings coming soon..."})]}),V=()=>{const[n,c]=p.useState("general"),b=[{key:"general",label:"General",icon:"mdi mdi-cog"},{key:"job-push-engine",label:"Job Push Engine",icon:"mdi mdi-rocket-launch"},{key:"deleted-items",label:"Deleted Items",icon:"mdi mdi-delete"},{key:"junk-emails",label:"Junk Emails",icon:"mdi mdi-email-alert"},{key:"archive",label:"Archive",icon:"mdi mdi-archive"},{key:"notes",label:"Notes",icon:"mdi mdi-note-text"}],l=()=>{switch(n){case"general":return e.jsx(k,{});case"job-push-engine":return e.jsx(I,{});case"deleted-items":return e.jsx(q,{});case"junk-emails":return e.jsx(B,{});case"archive":return e.jsx(J,{});case"notes":return e.jsx(K,{});default:return e.jsx(k,{})}};return e.jsxs(e.Fragment,{children:[e.jsx(L,{title:"Settings",subName:"Pages"}),e.jsxs(v,{children:[e.jsx(m,{lg:3,children:e.jsx(j,{children:e.jsxs(j.Body,{children:[e.jsx("h5",{className:"card-title mb-3",children:"Settings"}),e.jsx(f,{as:"ul",variant:"flush",className:"settings-menu",children:b.map(t=>e.jsxs(f.Item,{as:"li",action:!0,active:n===t.key,onClick:()=>c(t.key),className:"cursor-pointer",style:{cursor:"pointer"},children:[e.jsx("i",{className:`${t.icon} me-2`}),t.label]},t.key))})]})})}),e.jsx(m,{lg:9,children:e.jsx(j,{children:e.jsx(j.Body,{children:l()})})})]})]})};export{V as default};
