import{a6 as Z,a as B,r as u,j as e,P as D,d as g,f as m,h}from"./index-a9e214b4.js";import{b as F,u as k,a as P}from"./useZones-68238c9b.js";import{B as t}from"./Button-c6634469.js";import{S as b}from"./Spinner-c68c8441.js";import{B as x}from"./Badge-c8572097.js";import{A as f}from"./Alert-5ef9149f.js";import{F as a}from"./Form-e5c43690.js";import{T as z}from"./Table-5f1e4f5d.js";import{M as n}from"./Modal-878e73ef.js";import"./useQuery-e1aadf34.js";import"./useMutation-a538ea74.js";import"./hook-f634bac0.js";import"./ElementChildren-f40c06ab.js";import"./AbstractModalHeader-548c6b94.js";import"./useWindow-8ceca6d8.js";import"./hasClass-efbf25fe.js";import"./useMergedRefs-c337a093.js";import"./DataKey-e12315fd.js";const ee=()=>{const{parentId:d}=Z(),c=B(),[j,y]=u.useState(""),[A,l]=u.useState(!1),[i,o]=u.useState({name:"",code:"",description:""}),{data:r,isLoading:v}=F(d||""),{data:w=[],isLoading:S,error:C}=k({parentId:d}),p=P(),N=w.filter(s=>s.name.toLowerCase().includes(j.toLowerCase())||s.code.toLowerCase().includes(j.toLowerCase())),L=async s=>{if(s.preventDefault(),!!d)try{await p.mutateAsync({...i,parentId:d}),l(!1),o({name:"",code:"",description:""})}catch{}};return e.jsxs(e.Fragment,{children:[e.jsx(D,{title:`Child Zones - ${(r==null?void 0:r.name)||"Loading..."}`,subName:"Apps"}),e.jsx(g,{className:"mb-3",children:e.jsx(m,{children:e.jsxs(t,{variant:"secondary",onClick:()=>c("/apps/zones"),children:[e.jsx("i",{className:"mdi mdi-arrow-left me-1"})," Back to Zones"]})})}),e.jsxs(g,{children:[e.jsx(m,{lg:4,children:e.jsx(h,{children:e.jsx(h.Body,{children:v?e.jsxs("div",{className:"text-center py-3",children:[e.jsx(b,{animation:"border",variant:"primary",size:"sm"}),e.jsx("p",{className:"mt-2 mb-0 text-muted",children:"Loading parent zone..."})]}):r?e.jsxs(e.Fragment,{children:[e.jsx("h5",{className:"card-title mb-3",children:"Parent Zone Information"}),e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{children:"Code:"})," ",r.code]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{children:"Name:"})," ",r.name]}),r.description&&e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{children:"Description:"})," ",r.description]}),r.postCode&&e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{children:"Post Code:"})," ",r.postCode]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{children:"Status:"})," ",r.isActive!==void 0?r.isActive?e.jsx(x,{bg:"success",children:"Active"}):e.jsx(x,{bg:"secondary",children:"Inactive"}):e.jsx("span",{className:"text-muted",children:"-"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{children:"Created At:"})," ",new Date(r.createdAt).toLocaleString("vi-VN")]}),r.updatedAt&&e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{children:"Updated At:"})," ",new Date(r.updatedAt).toLocaleString("vi-VN")]}),r.zoneAreas&&r.zoneAreas.length>0&&e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{children:"Zone Areas:"})," ",r.zoneAreas.length," points"]}),e.jsx("div",{className:"mt-3",children:e.jsxs(t,{variant:"primary",onClick:()=>c(`/apps/zones/${r.id}`),className:"w-100",children:[e.jsx("i",{className:"mdi mdi-map-marker-path me-1"}),"View Geo Fence"]})})]}):e.jsx(f,{variant:"warning",children:"Parent zone not found or failed to load."})})})}),e.jsx(m,{lg:8,children:e.jsx(h,{children:e.jsxs(h.Body,{children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[e.jsx("div",{children:r&&e.jsxs("h5",{className:"mb-0",children:["Child Zones of: ",e.jsx("strong",{children:r.name})," (",r.code,")"]})}),e.jsxs(t,{variant:"primary",onClick:()=>l(!0),children:[e.jsx("i",{className:"uil uil-plus me-1"})," Create Child Zone"]})]}),e.jsx(g,{className:"mb-3",children:e.jsx(m,{md:6,children:e.jsx(a.Control,{type:"text",placeholder:"Search zones...",value:j,onChange:s=>y(s.target.value)})})}),C&&e.jsxs(f,{variant:"danger",dismissible:!0,children:["Failed to load zones: ",C.message]}),S||v?e.jsx("div",{className:"text-center py-5",children:e.jsx(b,{animation:"border",variant:"primary"})}):e.jsxs(z,{hover:!0,responsive:!0,children:[e.jsx("thead",{className:"table-light",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Code"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Description"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Created At"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:N.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"text-center py-4 text-muted",children:"No child zones found"})}):N.map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("strong",{children:s.code})}),e.jsx("td",{children:s.name}),e.jsx("td",{children:s.description||"-"}),e.jsx("td",{children:s.isActive!==void 0?s.isActive?e.jsx(x,{bg:"success",children:"Active"}):e.jsx(x,{bg:"secondary",children:"Inactive"}):e.jsx("span",{className:"text-muted",children:"-"})}),e.jsx("td",{children:new Date(s.createdAt).toLocaleDateString("vi-VN")}),e.jsx("td",{children:e.jsx("div",{className:"d-flex gap-2",children:s.id&&e.jsxs(e.Fragment,{children:[e.jsx(t,{variant:"info",size:"sm",onClick:()=>c(`/apps/zones/${s.id}/children`),children:"View Children"}),e.jsxs(t,{variant:"primary",size:"sm",onClick:()=>c(`/apps/zones/${s.id}`),children:[e.jsx("i",{className:"mdi mdi-map-marker-path me-1"}),"Geo Fence"]})]})})})]},s.id))})]})]})})})]}),e.jsxs(n,{show:A,onHide:()=>l(!1),children:[e.jsx(n.Header,{closeButton:!0,children:e.jsx(n.Title,{children:"Create New Child Zone"})}),e.jsxs(a,{onSubmit:L,children:[e.jsxs(n.Body,{children:[e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Zone Code *"}),e.jsx(a.Control,{type:"text",placeholder:"Q5",value:i.code,onChange:s=>o({...i,code:s.target.value}),required:!0})]}),e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Zone Name *"}),e.jsx(a.Control,{type:"text",placeholder:"Quan 5",value:i.name,onChange:s=>o({...i,name:s.target.value}),required:!0})]}),e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Description"}),e.jsx(a.Control,{as:"textarea",rows:3,placeholder:"trung tam tp",value:i.description,onChange:s=>o({...i,description:s.target.value})})]})]}),e.jsxs(n.Footer,{children:[e.jsx(t,{variant:"secondary",onClick:()=>l(!1),children:"Cancel"}),e.jsx(t,{variant:"primary",type:"submit",disabled:p.isPending,children:p.isPending?"Creating...":"Create Zone"})]})]})]})]})};export{ee as default};
