import{u}from"./useQuery-00218134.js";import{o as c,U as h,a7 as f}from"./index-1c09459b.js";import{u as l}from"./useMutation-cc409948.js";const d="https://api.dev.usta.vn",o=c.create({baseURL:`${d}/api`,timeout:3e4,headers:{"Content-Type":"application/json"}});o.interceptors.request.use(async e=>{const t=localStorage.getItem("_USTA_OAUTH");if(t)try{const s=JSON.parse(t);e.headers.Authorization=`Bearer ${s.accessToken}`,console.log("[Shift API] Request:",{method:e.method,url:e.url,params:e.params,hasAuth:!!e.headers.Authorization})}catch(s){console.error("[Shift API] Failed to parse OAuth session:",s)}else console.warn("[Shift API] No OAuth session found");return e},e=>(console.error("[Shift API] Request error:",e),Promise.reject(e)));o.interceptors.response.use(e=>(console.log("[Shift API] Response:",{status:e.status,url:e.config.url,data:e.data}),e),e=>{var t,s,r;return console.error("[Shift API] Response error:",{status:(t=e.response)==null?void 0:t.status,url:(s=e.config)==null?void 0:s.url,data:(r=e.response)==null?void 0:r.data,message:e.message}),Promise.reject(e)});async function p(e={}){console.log("[Shift API] Fetching shifts:",e);const t=await o.get("/shifts/",{params:e});if(t.data.success)return t.data.data;throw new Error(t.data.error||"Failed to fetch shifts")}async function m(e){var t,s,r,i;console.log("[Shift API] Creating shift:",e);try{const a=await o.post("/shifts/",e);if(a.data.success&&a.data.data)return a.data.data;throw new Error(a.data.error||a.data.message||"Failed to create shift")}catch(a){console.error("[Shift API] Error creating shift:",a);const n=((s=(t=a.response)==null?void 0:t.data)==null?void 0:s.error)||((i=(r=a.response)==null?void 0:r.data)==null?void 0:i.message)||a.message||"Failed to create shift";throw new Error(n)}}function A(e={}){return u({queryKey:["shifts",e],queryFn:()=>p(e),staleTime:3e4,retry:2,select:t=>t||[]})}function P(){const e=h(),{showNotification:t}=f();return l({mutationFn:s=>m(s),onSuccess:()=>{e.invalidateQueries({queryKey:["shifts"]}),t({message:"Shift created successfully",type:"success"})},onError:s=>{const r=(s==null?void 0:s.message)||"Failed to create shift";t({message:r,type:"error"})}})}export{P as a,A as u};
