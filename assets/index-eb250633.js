import{j as e,r as c,P as y,d as b,f as v,h as C,X as N}from"./index-7abc2e1c.js";import{S}from"./react-select.esm-b8c596d8.js";import{u as L,a as I}from"./useCategories-5c3ef674.js";import{B as g}from"./Badge-f7a378fe.js";import{B as d}from"./Button-98115848.js";import{A as M}from"./Alert-970a7765.js";import{S as P}from"./Spinner-f490c646.js";import{M as i}from"./Modal-d1b37a71.js";import{F as t}from"./Form-3dd09149.js";import"./hook-87ee9a06.js";import"./useQuery-fef0428f.js";import"./useMutation-04d1b243.js";import"./AbstractModalHeader-b51e44f5.js";import"./useWindow-25e16477.js";import"./hasClass-d6dc9e47.js";import"./useMergedRefs-c0c7f279.js";import"./DataKey-e12315fd.js";import"./FormControl-92329ab5.js";import"./ElementChildren-dbbb72ab.js";const w=[{Header:"ID",accessor:"id",defaultCanSort:!1,Cell:({value:a})=>e.jsxs("small",{className:"text-muted",children:[a.substring(0,8),"..."]})},{Header:"Code",accessor:"code",defaultCanSort:!0,Cell:({value:a})=>e.jsx(g,{bg:"primary",children:a})},{Header:"Name",accessor:"name",defaultCanSort:!0,Cell:({value:a})=>e.jsx("strong",{children:a})},{Header:"Level Code",accessor:"levelCode",defaultCanSort:!0,Cell:({value:a})=>e.jsx(g,{bg:"secondary",children:a})},{Header:"Parent ID",accessor:"parentId",defaultCanSort:!1,Cell:({value:a})=>a?e.jsxs("small",{className:"text-muted",children:[a.substring(0,8),"..."]}):e.jsx("span",{className:"text-muted",children:"—"})},{Header:"Description",accessor:"description",defaultCanSort:!1,Cell:({value:a})=>e.jsx("span",{className:"text-muted",children:a||"—"})},{Header:"Created At",accessor:"createdAt",defaultCanSort:!0,Cell:({value:a})=>new Date(a).toLocaleDateString()}],D=[{text:"10",value:10},{text:"25",value:25},{text:"50",value:50}],H=()=>{const[a,o]=c.useState(!1),[s,l]=c.useState({parentId:null,name:"",code:"",description:null}),{data:n,isLoading:h,error:m}=L(),u=I(),p=c.useMemo(()=>n?n.map(r=>({value:r.id,label:`${r.code} - ${r.name}`})):[],[n]),j=c.useMemo(()=>s.parentId&&p.find(r=>r.value===s.parentId)||null,[s.parentId,p]),f=async r=>{r.preventDefault();try{const x={...s,parentId:s.parentId||null,description:s.description||null};await u.mutateAsync(x),o(!1),l({parentId:null,name:"",code:"",description:null})}catch(x){console.error("Failed to create category:",x)}};return e.jsxs(e.Fragment,{children:[e.jsx(y,{title:"Categories",subName:"Apps"}),e.jsx(b,{children:e.jsx(v,{xs:12,children:e.jsx(C,{children:e.jsxs(C.Body,{children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[e.jsx("h4",{className:"header-title",children:"Categories List"}),e.jsxs(d,{variant:"primary",onClick:()=>o(!0),children:[e.jsx("i",{className:"mdi mdi-plus-circle me-1"}),"Create Category"]})]}),m&&e.jsxs(M,{variant:"danger",children:[e.jsx("strong",{children:"Error:"})," ",m instanceof Error?m.message:"Failed to load categories"]}),h?e.jsxs("div",{className:"text-center py-5",children:[e.jsx(P,{animation:"border",variant:"primary"}),e.jsx("p",{className:"mt-2",children:"Loading categories..."})]}):n&&n.length>0?e.jsx(N,{columns:w,data:n,pageSize:10,sizePerPageList:D,isSortable:!0,pagination:!0,isSearchable:!0}):e.jsxs("div",{className:"text-center py-5",children:[e.jsx("p",{className:"text-muted",children:"No categories found"}),e.jsx(d,{variant:"primary",onClick:()=>o(!0),children:"Create First Category"})]})]})})})}),e.jsxs(i,{show:a,onHide:()=>o(!1),children:[e.jsx(i.Header,{closeButton:!0,children:e.jsx(i.Title,{children:"Create New Category"})}),e.jsxs(t,{onSubmit:f,children:[e.jsxs(i.Body,{children:[e.jsxs(t.Group,{className:"mb-3",children:[e.jsx(t.Label,{children:"Category Name *"}),e.jsx(t.Control,{type:"text",placeholder:"Enter category name",value:s.name,onChange:r=>l({...s,name:r.target.value}),required:!0})]}),e.jsxs(t.Group,{className:"mb-3",children:[e.jsx(t.Label,{children:"Category Code *"}),e.jsx(t.Control,{type:"text",placeholder:"e.g., LM",value:s.code,onChange:r=>l({...s,code:r.target.value}),required:!0}),e.jsx(t.Text,{className:"text-muted",children:"Short code to identify this category"})]}),e.jsxs(t.Group,{className:"mb-3",children:[e.jsx(t.Label,{children:"Parent Category (Optional)"}),e.jsx(S,{className:"react-select",classNamePrefix:"react-select",placeholder:"Search and select a parent category...",isClearable:!0,isSearchable:!0,options:p,value:j,onChange:r=>{l({...s,parentId:r?r.value:null})},noOptionsMessage:()=>"No categories found",isLoading:h}),e.jsx(t.Text,{className:"text-muted",children:"Leave empty for root level category"})]}),e.jsxs(t.Group,{className:"mb-3",children:[e.jsx(t.Label,{children:"Description (Optional)"}),e.jsx(t.Control,{as:"textarea",rows:2,placeholder:"Enter description",value:s.description||"",onChange:r=>l({...s,description:r.target.value||null})})]})]}),e.jsxs(i.Footer,{children:[e.jsx(d,{variant:"secondary",onClick:()=>o(!1),children:"Cancel"}),e.jsx(d,{variant:"primary",type:"submit",disabled:u.isPending,children:u.isPending?"Creating...":"Create Category"})]})]})]})]})},Y=()=>e.jsx(H,{});export{Y as default};
