import{ab as F,a as A,r as w,j as s,P as x,d as a,f as r,h as d}from"./index-64b55cb4.js";import{F as U}from"./FileUploader-8b59ff4d.js";import{d as k,c as S,e as L}from"./useProducts-a551400b.js";import{A as g}from"./Alert-f161e921.js";import{S as I}from"./Spinner-a1d2bbfc.js";import{B as c}from"./Button-fd762df4.js";import{B as l}from"./Badge-114e085a.js";import{M as h}from"./Modal-0ade13d1.js";import{F as b}from"./Form-af4b6af5.js";import"./useQuery-419e495e.js";import"./useMutation-b6c6e57b.js";import"./hook-faf4790a.js";import"./AbstractModalHeader-f1d869ae.js";import"./useWindow-7982fea9.js";import"./hasClass-d3812cb5.js";import"./useMergedRefs-9644369a.js";import"./DataKey-e12315fd.js";import"./ElementChildren-3d5bbd53.js";const Z=()=>{const{id:t}=F(),m=A(),[B,p]=w.useState(!1),[o,y]=w.useState([]),{data:e,isLoading:f,error:v}=k(t||""),j=S(),u=L();if(!t)return s.jsxs(s.Fragment,{children:[s.jsx(x,{title:"Product Detail",subName:"Apps"}),s.jsx(g,{variant:"danger",children:"Product ID is required"})]});const D=i=>{switch(i){case 1:return s.jsx(l,{bg:"primary",children:"Service"});case 2:return s.jsx(l,{bg:"info",children:"Variant"});case 3:return s.jsx(l,{bg:"success",children:"Addon"});default:return s.jsx(l,{bg:"secondary",children:"Unknown"})}},N=i=>i.toLocaleString("vi-VN",{minimumFractionDigits:0,maximumFractionDigits:0}),C=async()=>{if(!(!t||o.length===0))try{await j.mutateAsync({productId:t,images:o}),y([]),alert("Images uploaded successfully!")}catch(i){alert("Failed to upload images: "+i.message)}},P=async i=>{if(t&&confirm("Are you sure you want to delete this image?"))try{await u.mutateAsync({productId:t,imageUrl:i}),alert("Image deleted successfully!")}catch(n){alert("Failed to delete image: "+n.message)}};return f?s.jsxs(s.Fragment,{children:[s.jsx(x,{title:"Product Detail",subName:"Apps"}),s.jsxs("div",{className:"text-center py-5",children:[s.jsx(I,{animation:"border",variant:"primary"}),s.jsx("p",{className:"mt-2",children:"Loading product details..."})]})]}):v?s.jsxs(s.Fragment,{children:[s.jsx(x,{title:"Product Detail",subName:"Apps"}),s.jsxs(g,{variant:"danger",children:[s.jsx("h5",{children:"Failed to load product"}),s.jsxs("p",{children:[s.jsx("strong",{children:"Error:"})," ",v.message]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Product ID:"})," ",t]}),s.jsx(c,{variant:"secondary",onClick:()=>m("/apps/products"),className:"mt-2",children:"Back to Products"})]})]}):!f&&!e?s.jsxs(s.Fragment,{children:[s.jsx(x,{title:"Product Detail",subName:"Apps"}),s.jsxs(g,{variant:"warning",children:[s.jsx("h5",{children:"Product not found"}),s.jsxs("p",{children:["No product found with ID: ",t]}),s.jsx(c,{variant:"secondary",onClick:()=>m("/apps/products"),className:"mt-2",children:"Back to Products"})]})]}):e?s.jsxs(s.Fragment,{children:[s.jsx(x,{title:"Product Detail",subName:"Apps"}),s.jsx(a,{children:s.jsx(r,{xs:12,children:s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[s.jsx("h4",{className:"header-title",children:"Product Information"}),s.jsxs(c,{variant:"secondary",onClick:()=>m("/apps/products"),children:[s.jsx("i",{className:"mdi mdi-arrow-left me-1"}),"Back to Products"]})]})})}),s.jsxs(a,{children:[s.jsxs(r,{md:8,children:[s.jsx(d,{children:s.jsxs(d.Body,{children:[s.jsxs(a,{className:"mb-3",children:[s.jsx(r,{md:4,children:s.jsx("strong",{children:"Product ID:"})}),s.jsx(r,{md:8,children:s.jsx("small",{className:"text-muted",children:e.id})})]}),s.jsxs(a,{className:"mb-3",children:[s.jsx(r,{md:4,children:s.jsx("strong",{children:"Name:"})}),s.jsx(r,{md:8,children:s.jsx("h5",{className:"mb-0",children:e.name})})]}),s.jsxs(a,{className:"mb-3",children:[s.jsx(r,{md:4,children:s.jsx("strong",{children:"Type:"})}),s.jsx(r,{md:8,children:D(e.type)})]}),s.jsxs(a,{className:"mb-3",children:[s.jsx(r,{md:4,children:s.jsx("strong",{children:"Price:"})}),s.jsx(r,{md:8,children:s.jsxs("h5",{className:"mb-0 text-primary",children:["₫",N(e.price)]})})]}),s.jsxs(a,{className:"mb-3",children:[s.jsx(r,{md:4,children:s.jsx("strong",{children:"Duration:"})}),s.jsx(r,{md:8,children:s.jsxs("span",{children:[e.duration," minutes"]})})]}),s.jsxs(a,{className:"mb-3",children:[s.jsx(r,{md:4,children:s.jsx("strong",{children:"Category ID:"})}),s.jsx(r,{md:8,children:s.jsx(l,{bg:"info",children:e.categoryId})})]}),s.jsxs(a,{className:"mb-3",children:[s.jsx(r,{md:4,children:s.jsx("strong",{children:"Category Level Code:"})}),s.jsx(r,{md:8,children:s.jsx(l,{bg:"secondary",children:e.categoryLevelCode})})]}),e.description&&s.jsxs(a,{className:"mb-3",children:[s.jsx(r,{md:4,children:s.jsx("strong",{children:"Description:"})}),s.jsx(r,{md:8,children:s.jsx("p",{className:"mb-0",children:e.description})})]}),e.detailUrl&&s.jsxs(a,{className:"mb-3",children:[s.jsx(r,{md:4,children:s.jsx("strong",{children:"Detail URL:"})}),s.jsx(r,{md:8,children:s.jsx("a",{href:e.detailUrl,target:"_blank",rel:"noopener noreferrer",children:e.detailUrl})})]}),s.jsxs(a,{className:"mb-3",children:[s.jsx(r,{md:4,children:s.jsx("strong",{children:"Status:"})}),s.jsx(r,{md:8,children:e.isActive?s.jsx(l,{bg:"success",children:"Active"}):s.jsx(l,{bg:"danger",children:"Inactive"})})]}),e.parentId&&s.jsxs(a,{className:"mb-3",children:[s.jsx(r,{md:4,children:s.jsx("strong",{children:"Parent Product ID:"})}),s.jsx(r,{md:8,children:s.jsx("small",{className:"text-muted",children:e.parentId})})]})]})}),e.variants&&e.variants.length>0&&s.jsx(d,{className:"mt-3",children:s.jsxs(d.Body,{children:[s.jsxs("h5",{className:"mb-3",children:[s.jsx(l,{bg:"info",className:"me-2",children:e.variants.length}),"Variants"]}),s.jsx(a,{className:"g-3",children:e.variants.map(i=>s.jsx(r,{xs:12,md:6,children:s.jsx(d,{className:"border-info h-100",children:s.jsxs(d.Body,{children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-2",children:[s.jsxs("div",{children:[s.jsx("h6",{className:"mb-1",children:i.name}),s.jsx(l,{bg:"info",className:"me-1",children:"Variant"})]}),s.jsxs(c,{variant:"outline-primary",size:"sm",onClick:()=>m(`/apps/products/${i.id}`),children:[s.jsx("i",{className:"mdi mdi-eye me-1"}),"View"]})]}),s.jsxs(a,{className:"mt-2",children:[s.jsxs(r,{xs:6,children:[s.jsx("small",{className:"text-muted",children:"Price:"}),s.jsxs("div",{className:"fw-bold text-primary",children:["₫",N(i.price)]})]}),s.jsxs(r,{xs:6,children:[s.jsx("small",{className:"text-muted",children:"Duration:"}),s.jsxs("div",{className:"fw-bold",children:[i.duration," min"]})]})]}),i.description&&s.jsx("div",{className:"mt-2",children:s.jsx("small",{className:"text-muted",children:i.description})})]})})},i.id))})]})}),e.addOns&&e.addOns.length>0&&s.jsx(d,{className:"mt-3",children:s.jsxs(d.Body,{children:[s.jsxs("h5",{className:"mb-3",children:[s.jsx(l,{bg:"success",className:"me-2",children:e.addOns.length}),"Addons"]}),s.jsx(a,{className:"g-3",children:e.addOns.map(i=>s.jsx(r,{xs:12,md:6,children:s.jsx(d,{className:"border-success h-100",children:s.jsxs(d.Body,{children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-2",children:[s.jsxs("div",{children:[s.jsx("h6",{className:"mb-1",children:i.name}),s.jsx(l,{bg:"success",className:"me-1",children:"Addon"})]}),s.jsxs(c,{variant:"outline-primary",size:"sm",onClick:()=>m(`/apps/products/${i.id}`),children:[s.jsx("i",{className:"mdi mdi-eye me-1"}),"View"]})]}),s.jsxs(a,{className:"mt-2",children:[s.jsxs(r,{xs:6,children:[s.jsx("small",{className:"text-muted",children:"Price:"}),s.jsxs("div",{className:"fw-bold text-primary",children:["₫",N(i.price)]})]}),s.jsxs(r,{xs:6,children:[s.jsx("small",{className:"text-muted",children:"Duration:"}),s.jsxs("div",{className:"fw-bold",children:[i.duration," min"]})]})]}),i.description&&s.jsx("div",{className:"mt-2",children:s.jsx("small",{className:"text-muted",children:i.description})})]})})},i.id))})]})})]}),s.jsxs(r,{md:4,children:[s.jsx(d,{className:"mb-3",children:s.jsxs(d.Body,{children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[s.jsx("h5",{className:"mb-0",children:"Product Images"}),s.jsxs(c,{variant:"primary",size:"sm",onClick:()=>p(!0),disabled:j.isPending||u.isPending,children:[s.jsx("i",{className:"mdi mdi-upload me-1"}),"Upload Images"]})]}),e.imageUrls&&e.imageUrls.length>0?s.jsx(a,{children:e.imageUrls.map((i,n)=>s.jsx(r,{xs:6,className:"mb-3",children:s.jsxs("div",{className:"position-relative",children:[s.jsx("img",{src:i,alt:`Product image ${n+1}`,className:"img-fluid rounded",style:{width:"100%",height:"150px",objectFit:"cover"}}),s.jsx(c,{variant:"danger",size:"sm",className:"position-absolute top-0 end-0 m-1",onClick:()=>P(i),disabled:u.isPending,children:s.jsx("i",{className:"mdi mdi-close"})})]})},n))}):s.jsx(g,{variant:"info",className:"mb-0",children:'No images uploaded yet. Click "Upload Images" to add product images.'})]})}),s.jsx(d,{children:s.jsxs(d.Body,{children:[s.jsx("h5",{className:"mb-3",children:"Metadata"}),s.jsx(a,{className:"mb-3",children:s.jsxs(r,{xs:12,children:[s.jsx("strong",{children:"Created By:"}),s.jsx("br",{}),s.jsx("small",{className:"text-muted",children:e.createdBy})]})}),s.jsx(a,{className:"mb-3",children:s.jsxs(r,{xs:12,children:[s.jsx("strong",{children:"Created At:"}),s.jsx("br",{}),s.jsx("small",{className:"text-muted",children:new Date(e.createdAt).toLocaleString()})]})}),e.updatedBy&&s.jsx(a,{className:"mb-3",children:s.jsxs(r,{xs:12,children:[s.jsx("strong",{children:"Updated By:"}),s.jsx("br",{}),s.jsx("small",{className:"text-muted",children:e.updatedBy})]})}),e.updatedAt&&s.jsx(a,{className:"mb-3",children:s.jsxs(r,{xs:12,children:[s.jsx("strong",{children:"Updated At:"}),s.jsx("br",{}),s.jsx("small",{className:"text-muted",children:new Date(e.updatedAt).toLocaleString()})]})})]})})]})]}),s.jsxs(h,{show:B,onHide:()=>p(!1),size:"lg",centered:!0,children:[s.jsx(h.Header,{closeButton:!0,children:s.jsx(h.Title,{children:"Upload Product Images"})}),s.jsxs(h.Body,{style:{maxHeight:"70vh",overflowY:"auto"},children:[s.jsxs(b.Group,{className:"mb-3",children:[s.jsx(b.Label,{children:"Select Images"}),s.jsx(U,{showPreview:!0,onFileUpload:i=>y(i)}),s.jsx(b.Text,{className:"text-muted",children:"You can upload multiple images. Images will be associated with this product."})]}),e.imageUrls&&e.imageUrls.length>0&&s.jsxs(s.Fragment,{children:[s.jsx("hr",{}),s.jsx("h6",{children:"Current Images"}),s.jsx(a,{children:e.imageUrls.map((i,n)=>s.jsx(r,{xs:6,md:4,className:"mb-3",children:s.jsxs("div",{className:"position-relative",children:[s.jsx("img",{src:i,alt:`Product image ${n+1}`,className:"img-fluid rounded",style:{width:"100%",height:"150px",objectFit:"cover"}}),s.jsx(c,{variant:"danger",size:"sm",className:"position-absolute top-0 end-0 m-1",onClick:()=>P(i),disabled:u.isPending,children:s.jsx("i",{className:"mdi mdi-close"})})]})},n))})]})]}),s.jsxs(h.Footer,{children:[s.jsx(c,{variant:"secondary",onClick:()=>p(!1),children:"Cancel"}),s.jsx(c,{variant:"primary",onClick:C,disabled:o.length===0||j.isPending,children:j.isPending?s.jsxs(s.Fragment,{children:[s.jsx(I,{animation:"border",size:"sm",className:"me-2"}),"Uploading..."]}):s.jsxs(s.Fragment,{children:[s.jsx("i",{className:"mdi mdi-upload me-1"}),"Upload ",o.length>0&&`(${o.length})`]})})]})]})]}):null};export{Z as default};
