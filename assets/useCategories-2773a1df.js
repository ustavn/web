import{u as s}from"./useQuery-4147274f.js";import{w as n,aZ as u}from"./index-049ade0a.js";import{u as c}from"./useMutation-56f107bc.js";const i="https://api.dev.usta.vn",r=n.create({baseURL:`${i}/api`,timeout:3e4,headers:{"Content-Type":"application/json"}});r.interceptors.request.use(async e=>{const t=localStorage.getItem("_USTA_OAUTH");if(t)try{const a=JSON.parse(t);e.headers.Authorization=`Bearer ${a.accessToken}`,console.log("[Category API] Request:",{method:e.method,url:e.url,params:e.params,data:e.data,hasAuth:!!e.headers.Authorization})}catch(a){console.error("[Category API] Failed to parse OAuth session:",a)}else console.warn("[Category API] No OAuth session found");return e},e=>(console.error("[Category API] Request error:",e),Promise.reject(e)));r.interceptors.response.use(e=>(console.log("[Category API] Response:",{status:e.status,url:e.config.url,data:e.data}),e),e=>{var t,a,o;return console.error("[Category API] Response error:",{status:(t=e.response)==null?void 0:t.status,url:(a=e.config)==null?void 0:a.url,data:(o=e.response)==null?void 0:o.data,message:e.message}),Promise.reject(e)});async function l(e={}){console.log("[Category API] Fetching categories:",e);const t=await r.get("/categories/");if(t.data.success)return t.data.data;throw new Error(t.data.error||"Failed to fetch categories")}async function g(e){console.log("[Category API] Creating category:",e);const t=await r.post("/categories/",e);if(console.log("[Category API] Category created successfully:",t.data),t.data.success)return t.data.data;throw new Error(t.data.error||"Failed to create category")}function p(e={}){return s({queryKey:["categories",e],queryFn:()=>l(e),staleTime:3e4,retry:2,select:t=>t||[]})}function h(){const e=u();return c({mutationFn:t=>g(t),onSuccess:t=>{console.log("[useCreateCategory] Category created successfully:",t),e.invalidateQueries({queryKey:["categories"]})},onError:t=>{console.error("[useCreateCategory] Failed to create category:",t)}})}export{h as a,p as u};
