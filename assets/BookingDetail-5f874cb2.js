import{aX as v,a as k,j as e,P as c,d as n,f as l,h as t}from"./index-1c09459b.js";import{u as B}from"./index-26ff7582.js";import{u as w}from"./useProducts-ffefb872.js";import{A as g}from"./Alert-582bd80a.js";import{S as y}from"./Spinner-ed2097a1.js";import{B as b}from"./Button-f56a0820.js";import{T as D}from"./Table-3ddf39e5.js";import{B as a}from"./Badge-8e317aab.js";import"./Form-9237be30.js";import"./FormControl-e238e16f.js";import"./ElementChildren-ab2d58d5.js";import"./useQuery-00218134.js";import"./useMutation-cc409948.js";import"./hook-95b25f1d.js";import"./Nav-2f954c07.js";import"./DataKey-e12315fd.js";import"./NavContext-6ce83af4.js";import"./useMergedRefs-7e23477e.js";import"./NavbarContext-25385990.js";import"./ButtonGroup-17e0a310.js";import"./Modal-1b87b88a.js";import"./AbstractModalHeader-a20fb1bf.js";import"./useWindow-687076da.js";import"./hasClass-87521f5b.js";const Z=()=>{const{id:o}=v(),m=k();console.log("[BookingDetail] Component rendered"),console.log("[BookingDetail] useParams id:",o),console.log("[BookingDetail] window.location:",window.location.pathname);const x=B(o||""),{data:s,isLoading:h,error:j}=x,{data:N=[]}=w();if(console.log("[BookingDetail] Hook state:",{booking:s,isLoading:h,error:j,isFetching:x.isFetching,isError:x.isError}),!o)return e.jsxs(e.Fragment,{children:[e.jsx(c,{title:"Booking Detail",subName:"Apps"}),e.jsx(g,{variant:"danger",children:"Booking ID is required"})]});const p=r=>{if(typeof r=="number")switch(r){case 1:return e.jsx(a,{bg:"info",children:"Created"});case 2:return e.jsx(a,{bg:"primary",children:"Assigned"});case 3:return e.jsx(a,{bg:"warning",children:"In Progress"});case 4:return e.jsx(a,{bg:"success",children:"Done"});case 5:return e.jsx(a,{bg:"danger",children:"Failed"});case 6:return e.jsx(a,{bg:"secondary",children:"Cancelled"});default:return e.jsxs(a,{bg:"secondary",children:["Status ",r]})}return e.jsx(a,{bg:"info",children:r||"Unknown"})},u=r=>N.find(d=>d.id===r);return h?e.jsxs(e.Fragment,{children:[e.jsx(c,{title:"Booking Detail",subName:"Apps"}),e.jsxs("div",{className:"text-center py-5",children:[e.jsx(y,{animation:"border",variant:"primary"}),e.jsx("p",{className:"mt-2",children:"Loading booking details..."})]})]}):j?e.jsxs(e.Fragment,{children:[e.jsx(c,{title:"Booking Detail",subName:"Apps"}),e.jsxs(g,{variant:"danger",children:[e.jsx("h5",{children:"Failed to load booking"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Error:"})," ",j.message]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Booking ID:"})," ",o]}),e.jsx(b,{variant:"secondary",onClick:()=>m("/apps/booking"),className:"mt-2",children:"Back to Bookings"})]})]}):!h&&!s?e.jsxs(e.Fragment,{children:[e.jsx(c,{title:"Booking Detail",subName:"Apps"}),e.jsxs(g,{variant:"warning",children:[e.jsx("h5",{children:"Booking not found"}),e.jsxs("p",{children:["No booking found with ID: ",o]}),e.jsx(b,{variant:"secondary",onClick:()=>m("/apps/booking"),className:"mt-2",children:"Back to Bookings"})]})]}):s?e.jsxs(e.Fragment,{children:[e.jsx(c,{title:"Booking Detail",subName:"Apps"}),e.jsx(n,{children:e.jsxs(l,{xs:12,children:[e.jsx("div",{className:"mb-3",children:e.jsxs(b,{variant:"secondary",onClick:()=>m("/apps/booking"),children:[e.jsx("i",{className:"mdi mdi-arrow-left me-1"})," Back to Bookings"]})}),e.jsxs(t,{className:"mb-3",children:[e.jsx(t.Header,{children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsx("h4",{className:"mb-0",children:"Booking Information"}),p(s.status)]})}),e.jsxs(t.Body,{children:[e.jsxs(n,{children:[e.jsx(l,{md:6,children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label fw-bold text-muted",children:"Booking ID"}),e.jsx("div",{className:"form-control-plaintext",children:e.jsx("code",{children:s.id})})]})}),e.jsx(l,{md:6,children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label fw-bold text-muted",children:"Booking Time"}),e.jsx("div",{className:"form-control-plaintext",children:new Date(s.bookingTime).toLocaleString("vi-VN",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})})]})})]}),e.jsx("hr",{}),e.jsxs(n,{children:[e.jsx(l,{md:6,children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label fw-bold text-muted",children:"Customer Name"}),e.jsx("div",{className:"form-control-plaintext",children:s.customerName||e.jsx("span",{className:"text-muted",children:"Not provided"})})]})}),e.jsx(l,{md:6,children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label fw-bold text-muted",children:"Customer Phone"}),e.jsx("div",{className:"form-control-plaintext",children:s.customerPhone||e.jsx("span",{className:"text-muted",children:"-"})})]})})]}),s.customerId&&e.jsx(n,{children:e.jsx(l,{md:6,children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label fw-bold text-muted",children:"Customer ID"}),e.jsx("div",{className:"form-control-plaintext",children:e.jsx("code",{children:s.customerId})})]})})}),e.jsx("hr",{}),e.jsx(n,{children:e.jsx(l,{md:12,children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label fw-bold text-muted",children:"Address"}),e.jsx("div",{className:"form-control-plaintext",children:s.address||e.jsx("span",{className:"text-muted",children:"Not provided"})})]})})}),s.latitude!==void 0&&s.longitude!==void 0&&e.jsx(n,{children:e.jsx(l,{md:6,children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label fw-bold text-muted",children:"Coordinates"}),e.jsx("div",{className:"form-control-plaintext",children:e.jsxs("small",{children:["Latitude: ",s.latitude.toFixed(6),", Longitude: ",s.longitude.toFixed(6)]})})]})})})]})]}),s.items&&s.items.length>0&&e.jsxs(t,{className:"mb-3",children:[e.jsx(t.Header,{children:e.jsx("h4",{className:"mb-0",children:"Booking Items"})}),e.jsx(t.Body,{children:e.jsxs(D,{hover:!0,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Product"}),e.jsx("th",{children:"Price"}),e.jsx("th",{children:"Quantity"}),e.jsx("th",{children:"Subtotal"})]})}),e.jsx("tbody",{children:s.items.map((r,d)=>{const i=u(r.productId),f=((i==null?void 0:i.price)||0)*r.quantity;return e.jsxs("tr",{children:[e.jsxs("td",{children:[e.jsx("strong",{children:(i==null?void 0:i.name)||r.productId}),(i==null?void 0:i.description)&&e.jsx("div",{className:"text-muted small",children:i.description})]}),e.jsx("td",{children:i!=null&&i.price?e.jsxs(e.Fragment,{children:[i.price.toLocaleString("vi-VN")," VND"]}):e.jsx("span",{className:"text-muted",children:"N/A"})}),e.jsx("td",{children:e.jsx(a,{bg:"info",children:r.quantity})}),e.jsx("td",{children:e.jsxs("strong",{children:[f.toLocaleString("vi-VN")," VND"]})})]},d)})}),e.jsx("tfoot",{children:e.jsxs("tr",{children:[e.jsx("td",{colSpan:3,className:"text-end fw-bold",children:"Total Price:"}),e.jsx("td",{className:"fw-bold",children:s.totalPrice?e.jsxs(e.Fragment,{children:[s.totalPrice.toLocaleString("vi-VN")," VND"]}):e.jsxs(e.Fragment,{children:[s.items.reduce((r,d)=>{const i=u(d.productId);return r+((i==null?void 0:i.price)||0)*d.quantity},0).toLocaleString("vi-VN")," ","VND"]})})]})})]})})]}),e.jsxs(t,{children:[e.jsx(t.Header,{children:e.jsx("h4",{className:"mb-0",children:"Additional Information"})}),e.jsxs(t.Body,{children:[e.jsxs(n,{children:[s.createdBy&&e.jsx(l,{md:6,children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label fw-bold text-muted",children:"Created By"}),e.jsx("div",{className:"form-control-plaintext",children:e.jsx("code",{children:s.createdBy})})]})}),s.technicianId&&e.jsx(l,{md:6,children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label fw-bold text-muted",children:"Technician ID"}),e.jsx("div",{className:"form-control-plaintext",children:e.jsx("code",{children:s.technicianId})})]})})]}),e.jsxs(n,{children:[s.createdAt&&e.jsx(l,{md:6,children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label fw-bold text-muted",children:"Created At"}),e.jsx("div",{className:"form-control-plaintext",children:new Date(s.createdAt).toLocaleString("vi-VN")})]})}),s.updatedAt&&e.jsx(l,{md:6,children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label fw-bold text-muted",children:"Updated At"}),e.jsx("div",{className:"form-control-plaintext",children:new Date(s.updatedAt).toLocaleString("vi-VN")})]})})]}),s.totalPrice&&e.jsx(n,{children:e.jsx(l,{md:6,children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label fw-bold text-muted",children:"Total Price"}),e.jsx("div",{className:"form-control-plaintext",children:e.jsxs("h5",{className:"mb-0 text-primary",children:[s.totalPrice.toLocaleString("vi-VN")," VND"]})})]})})})]})]})]})})]}):null};export{Z as default};
