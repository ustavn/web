import{u as h,a as x,b as g,r as l,j as e,e as p,p as f,g as j}from"./index-71e367a9.js";import{S as k}from"./Spinner-ffd7a3b9.js";function T(){const[a]=h(),s=x(),{saveOAuthSession:r}=g(),[c,n]=l.useState("");return l.useEffect(()=>{(async()=>{const o=a.get("code"),i=a.get("error"),d=a.get("error_description");if(i){n(d||i),setTimeout(()=>s("/account/login"),3e3);return}if(!o){n("Authorization code not found"),setTimeout(()=>s("/account/login"),3e3);return}try{const t=await p(o),m=f(t.access_token);r({accessToken:t.access_token,refreshToken:t.refresh_token,idToken:t.id_token,expiresAt:Date.now()+t.expires_in*1e3,user:m});const u=j();s(u)}catch(t){n(t.message||"Failed to complete authentication"),setTimeout(()=>s("/account/login"),3e3)}})()},[a,s,r]),e.jsx("div",{className:"d-flex flex-column align-items-center justify-content-center",style:{minHeight:"100vh"},children:c?e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-danger mb-3",children:e.jsx("i",{className:"mdi mdi-alert-circle",style:{fontSize:"48px"}})}),e.jsx("h4",{className:"text-danger mb-2",children:"Authentication Failed"}),e.jsx("p",{className:"text-muted",children:c}),e.jsx("p",{className:"text-muted",children:"Redirecting to login..."})]}):e.jsxs("div",{className:"text-center",children:[e.jsx(k,{animation:"border",variant:"primary",className:"mb-3"}),e.jsx("h4",{className:"mb-2",children:"Completing authentication..."}),e.jsx("p",{className:"text-muted",children:"Please wait while we log you in."})]})})}export{T as default};
