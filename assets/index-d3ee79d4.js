import{r as p,z as L,J as $,j as e,l as T,aW as I,U as w,d as f,f as j,P as A,h as N}from"./index-7abc2e1c.js";import{u as B}from"./useQuery-fef0428f.js";import{u as D}from"./useMutation-04d1b243.js";import{S as k}from"./Spinner-f490c646.js";import{F as m}from"./Form-3dd09149.js";import{A as y}from"./Alert-970a7765.js";import{u as G}from"./hook-87ee9a06.js";import{u as J,B as K}from"./Nav-d0d45958.js";import{m as q}from"./NavContext-cbce7ab2.js";import"./FormControl-92329ab5.js";import"./ElementChildren-dbbb72ab.js";import"./DataKey-e12315fd.js";import"./useMergedRefs-c0c7f279.js";const E=p.forwardRef(({bsPrefix:a,active:r,disabled:u,eventKey:c,className:t,variant:h,action:d,as:b,...i},x)=>{a=L(a,"list-group-item");const[s,o]=J({key:q(c,i.href),active:r,...i}),n=$(l=>{if(u){l.preventDefault(),l.stopPropagation();return}s.onClick(l)});u&&i.tabIndex===void 0&&(i.tabIndex=-1,i["aria-disabled"]=!0);const g=b||(d?i.href?"a":"button":"div");return e.jsx(g,{ref:x,...i,...s,onClick:n,className:T(t,a,o.isActive&&"active",u&&"disabled",h&&`${a}-${h}`,d&&`${a}-action`)})});E.displayName="ListGroupItem";const z=E,P=p.forwardRef((a,r)=>{const{className:u,bsPrefix:c,variant:t,horizontal:h,numbered:d,as:b="div",...i}=G(a,{activeKey:"onSelect"}),x=L(c,"list-group");let s;return h&&(s=h===!0?"horizontal":`horizontal-${h}`),e.jsx(K,{ref:r,...i,as:b,className:T(u,x,t&&`${x}-${t}`,s&&`${x}-${s}`,d&&`${x}-numbered`)})});P.displayName="ListGroup";const F=Object.assign(P,{Item:z}),C=()=>e.jsxs("div",{children:[e.jsxs("h5",{className:"mb-4 text-uppercase",children:[e.jsx("i",{className:"mdi mdi-cog me-1"})," General Settings"]}),e.jsx("p",{className:"text-muted",children:"Settings coming soon..."})]});function O(){return B({queryKey:["booking-scan-settings"],queryFn:()=>I.getSettings(),staleTime:3e4,retry:2,select:a=>a||[]})}function R(){const a=w();return D({mutationFn:r=>I.saveSettings(r),onSuccess:()=>{a.invalidateQueries({queryKey:["booking-scan-settings"]})},onError:r=>{console.error("[useSaveBookingScanSettings] Failed to save settings:",r)}})}const M=()=>{const{data:a,isLoading:r,isError:u}=O(),c=R(),[t,h]=p.useState({radiusFirst:"1",radiusSecond:"1",radiusThird:"1",radiusFourth:"1",waitTime:"10"}),d=Array.from({length:15},(s,o)=>o+1).map(s=>({value:s.toString(),label:`${s} km`}));d.push({value:"all",label:"Tất cả"});const b=[5,10,15,20,25,30,35,40,45,50];p.useEffect(()=>{var s,o;if(a&&a.length>0){const n={waitTime:((o=(s=a[0])==null?void 0:s.scanIntervalMinutes)==null?void 0:o.toString())||"10"};a.forEach(g=>{const l=g.scanOrder,S=g.scanDistanceKm,v=S===-1?"all":S.toString();l===1&&(n.radiusFirst=v),l===2&&(n.radiusSecond=v),l===3&&(n.radiusThird=v),l===4&&(n.radiusFourth=v)}),h(g=>({...g,...n}))}},[a]);const i=(s,o)=>{h(n=>({...n,[s]:o}))},x=async s=>{s.preventDefault();const o=[1,2,3,4].map(n=>{const l=t[`radius${n===1?"First":n===2?"Second":n===3?"Third":"Fourth"}`],S=l==="all"?-1:parseFloat(l),v=parseInt(t.waitTime);return{scanDistanceKm:S,scanIntervalMinutes:v,scanOrder:n}});try{await c.mutateAsync(o)}catch(n){console.error("Failed to save settings:",n)}};return r?e.jsxs("div",{className:"text-center py-4",children:[e.jsx(k,{animation:"border",variant:"primary"}),e.jsx("p",{className:"mt-2 text-muted",children:"Loading settings..."})]}):e.jsxs(m,{onSubmit:x,children:[e.jsxs("h5",{className:"mb-4 text-uppercase",children:[e.jsx("i",{className:"mdi mdi-rocket-launch me-1"})," Job Push Engine Settings"]}),u&&e.jsx(y,{variant:"danger",className:"mb-3",children:"Failed to load settings. Please try again."}),c.isError&&e.jsx(y,{variant:"danger",className:"mb-3",children:"Failed to save settings. Please try again."}),c.isSuccess&&e.jsx(y,{variant:"success",className:"mb-3",children:"Settings saved successfully!"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h6",{className:"mb-2",children:"Radius"}),e.jsx("p",{className:"text-muted mb-3",children:"Cài đặt giá trị bán kính cho phép hệ thống quét tìm đối tác để đẩy job"}),e.jsxs(f,{children:[e.jsxs(j,{md:6,className:"mb-3",children:[e.jsx(m.Label,{children:"Lần đầu"}),e.jsx(m.Select,{name:"radiusFirst",value:t.radiusFirst,onChange:s=>i("radiusFirst",s.target.value),children:d.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]}),e.jsxs(j,{md:6,className:"mb-3",children:[e.jsx(m.Label,{children:"Lần 2"}),e.jsx(m.Select,{name:"radiusSecond",value:t.radiusSecond,onChange:s=>i("radiusSecond",s.target.value),children:d.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]})]}),e.jsxs(f,{children:[e.jsxs(j,{md:6,className:"mb-3",children:[e.jsx(m.Label,{children:"Lần 3"}),e.jsx(m.Select,{name:"radiusThird",value:t.radiusThird,onChange:s=>i("radiusThird",s.target.value),children:d.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]}),e.jsxs(j,{md:6,className:"mb-3",children:[e.jsx(m.Label,{children:"Lần 4"}),e.jsx(m.Select,{name:"radiusFourth",value:t.radiusFourth,onChange:s=>i("radiusFourth",s.target.value),children:d.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h6",{className:"mb-2",children:"Khoảng cách push"}),e.jsx("p",{className:"text-muted mb-3",children:"Thời gian chờ giữa các lần mở rộng bán kính quét"}),e.jsx(f,{children:e.jsxs(j,{md:6,className:"mb-3",children:[e.jsx(m.Label,{children:"Thời gian chờ"}),e.jsx(m.Select,{name:"waitTime",value:t.waitTime,onChange:s=>i("waitTime",s.target.value),children:b.map(s=>e.jsxs("option",{value:s,children:[s," Phút"]},s))})]})})]}),e.jsx("div",{className:"text-end",children:e.jsx("button",{type:"submit",className:"btn btn-success mt-2",disabled:c.isPending,children:c.isPending?e.jsxs(e.Fragment,{children:[e.jsx(k,{animation:"border",size:"sm",className:"me-2"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"mdi mdi-content-save"})," Save Changes"]})})})]})},Q=()=>e.jsxs("div",{children:[e.jsxs("h5",{className:"mb-4 text-uppercase",children:[e.jsx("i",{className:"mdi mdi-delete me-1"})," Deleted Items Settings"]}),e.jsx("p",{className:"text-muted",children:"Settings coming soon..."})]}),V=()=>e.jsxs("div",{children:[e.jsxs("h5",{className:"mb-4 text-uppercase",children:[e.jsx("i",{className:"mdi mdi-email-alert me-1"})," Junk Emails Settings"]}),e.jsx("p",{className:"text-muted",children:"Settings coming soon..."})]}),U=()=>e.jsxs("div",{children:[e.jsxs("h5",{className:"mb-4 text-uppercase",children:[e.jsx("i",{className:"mdi mdi-archive me-1"})," Archive Settings"]}),e.jsx("p",{className:"text-muted",children:"Settings coming soon..."})]}),W=()=>e.jsxs("div",{children:[e.jsxs("h5",{className:"mb-4 text-uppercase",children:[e.jsx("i",{className:"mdi mdi-note-text me-1"})," Notes Settings"]}),e.jsx("p",{className:"text-muted",children:"Settings coming soon..."})]}),le=()=>{const[a,r]=p.useState("general"),u=[{key:"general",label:"General",icon:"mdi mdi-cog"},{key:"job-push-engine",label:"Job Push Engine",icon:"mdi mdi-rocket-launch"},{key:"deleted-items",label:"Deleted Items",icon:"mdi mdi-delete"},{key:"junk-emails",label:"Junk Emails",icon:"mdi mdi-email-alert"},{key:"archive",label:"Archive",icon:"mdi mdi-archive"},{key:"notes",label:"Notes",icon:"mdi mdi-note-text"}],c=()=>{switch(a){case"general":return e.jsx(C,{});case"job-push-engine":return e.jsx(M,{});case"deleted-items":return e.jsx(Q,{});case"junk-emails":return e.jsx(V,{});case"archive":return e.jsx(U,{});case"notes":return e.jsx(W,{});default:return e.jsx(C,{})}};return e.jsxs(e.Fragment,{children:[e.jsx(A,{title:"Settings",subName:"Pages"}),e.jsxs(f,{children:[e.jsx(j,{lg:3,children:e.jsx(N,{children:e.jsxs(N.Body,{children:[e.jsx("h5",{className:"card-title mb-3",children:"Settings"}),e.jsx(F,{as:"ul",variant:"flush",className:"settings-menu",children:u.map(t=>e.jsxs(F.Item,{as:"li",action:!0,active:a===t.key,onClick:()=>r(t.key),className:"cursor-pointer",style:{cursor:"pointer"},children:[e.jsx("i",{className:`${t.icon} me-2`}),t.label]},t.key))})]})})}),e.jsx(j,{lg:9,children:e.jsx(N,{children:e.jsx(N.Body,{children:c()})})})]})]})};export{le as default};
